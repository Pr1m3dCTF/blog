<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Pr1m3d Team Blog">
      
      
        <meta name="author" content="Pr1m3d">
      
      
        <link rel="canonical" href="https://pr1m3dctf.github.io/blog/CTF/writeups/2025/Cyber-Apocalypse-2025/crypto/twin-oracle/">
      
      
        <link rel="prev" href="../../">
      
      
        <link rel="next" href="../../../Iran-Tech-Olympics-CTF-2025/">
      
      
      <link rel="icon" href="../../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Twin Oracle - Pr1m3d Team Blog</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../../assets/css/extra.css">
    
    <script>__md_scope=new URL("../../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mydark" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#twin-oracle" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../../.." title="Pr1m3d Team Blog" class="md-header__button md-logo" aria-label="Pr1m3d Team Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pr1m3d Team Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Twin Oracle
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="mydark" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="mylight" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Pr1m3dCTF/blog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    Pr1m3dCTF/blog
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../Researches/" class="md-tabs__link">
        
  
  
    
  
  Research

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../Blog-Posts/" class="md-tabs__link">
          
  
  
    
  
  Blog Post

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../../CVE/" class="md-tabs__link">
          
  
  
    
  
  CVE

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../../" class="md-tabs__link">
          
  
  
    
  
  CTF

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../Contact-Us/" class="md-tabs__link">
        
  
  
    
  
  Contact Us

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../../About-Us/" class="md-tabs__link">
        
  
  
    
  
  About Us

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../../.." title="Pr1m3d Team Blog" class="md-nav__button md-logo" aria-label="Pr1m3d Team Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    Pr1m3d Team Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Pr1m3dCTF/blog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    Pr1m3dCTF/blog
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../Researches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../Blog-Posts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog Post
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../CVE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CVE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CTF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../Contact-Us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact Us
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../About-Us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About Us
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../Researches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../Blog-Posts/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Blog Post
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Blog Post
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../Blog-Posts/Android-Stack-Overflow-Exploitation-with-Frida/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Stack Overflow Exploitation with Frida
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../Blog-Posts/Msfvenom-Android-Malware-Analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analyzing MSFVenom Android Payload
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../Blog-Posts/HTB-Busqueda-Machine-Writeup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HTB Busqueda Machine Writeup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../Blog-Posts/PWN-Stack-binary-exploiting-Writeup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PWN - Stack binary exploiting Writeup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../../CVE/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    CVE
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            CVE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../CVE/CVE-2023-48114/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stored XSS in Email Body of SmarterMail (CVE-2023-48114)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../CVE/CVE-2023-48115/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stored DOM XSS in Email Body of SmarterMail (CVE-2023-48115)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../CVE/CVE-2023-48116/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stored XSS in Calendar component of SmarterMail (CVE-2023-48116)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    CTF
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    writeups
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            writeups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1">
        
          
          <label class="md-nav__link" for="__nav_5_2_1" id="__nav_5_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2023
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1">
            <span class="md-nav__icon md-icon"></span>
            2023
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1" id="__nav_5_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cyber Apocalypse 2023
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            Cyber Apocalypse 2023
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_1">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_1" id="__nav_5_2_1_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/cyber-apocalypse-2023/crypto/inside_the_matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    inside the matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/cyber-apocalypse-2023/crypto/multipage_recyclings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    multipage recyclings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/cyber-apocalypse-2023/crypto/perfect_synchronization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    perfect synchronization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/cyber-apocalypse-2023/crypto/small_steps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    small steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_2" id="__nav_5_2_1_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    blockchain
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            blockchain
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/cyber-apocalypse-2023/blockchain/navigating_the_unknown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    navigating the unknown
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/cyber-apocalypse-2023/blockchain/shooting_101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    shooting 101
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_3">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_3" id="__nav_5_2_1_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    web
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/cyber-apocalypse-2023/web/passman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    passman
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_4">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_4" id="__nav_5_2_1_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    hardware
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            hardware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/cyber-apocalypse-2023/hardware/hm74/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hm74
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_5">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_5" id="__nav_5_2_1_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    forensics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            forensics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2023/cyber-apocalypse-2023/forensics/packet_cyclone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    packet cyclone
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../2024/Snapp-ctf-2024/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Snapp CTF 2024
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2_1" id="__nav_5_2_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            Snapp CTF 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_2" id="__nav_5_2_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/crypto/Cryptos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cryptos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/crypto/Bombastic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bombastic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/crypto/Blex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blex
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/crypto/Grail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grail
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_3">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_3" id="__nav_5_2_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    pwn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            pwn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/pwn/snapp_admin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp admin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/pwn/snapp_shell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp shell
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_4">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_4" id="__nav_5_2_2_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    rev
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            rev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/rev/visits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/rev/turnob/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TurnOB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/rev/blink/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blink
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_5">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_5" id="__nav_5_2_2_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    web
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/web/snapp_cat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp cat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/web/snapp_fal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp fal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/web/welcome/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    welcome
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_6">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_6" id="__nav_5_2_2_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    forensics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            forensics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/forensics/snapp_report/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Report
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_7">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_7" id="__nav_5_2_2_1_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    osint
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_7">
            <span class="md-nav__icon md-icon"></span>
            osint
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/osint/snapp_records/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Records
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/osint/snapp_bounties/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Bounties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/osint/snapp_customers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Customers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Snapp-ctf-2024/osint/snapp_saving/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Saving
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_2" id="__nav_5_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cyber Apocalypse 2024
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Cyber Apocalypse 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_2_1">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_2_1" id="__nav_5_2_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Cyber-Apocalypse-2024/crypto/permuted/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Permuted
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_2_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_2_2" id="__nav_5_2_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    blockchain
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            blockchain
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Cyber-Apocalypse-2024/blockchain/luckyfaucet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lucky Facucet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Cyber-Apocalypse-2024/blockchain/russianroulette/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Russian Roulette
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/Cyber-Apocalypse-2024/blockchain/ledgerheist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ledger Heist
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_3">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_3" id="__nav_5_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Just CTF 2024
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Just CTF 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../2024/JustCTF2024/blockchain/blockchains/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    blockchain
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2_3" id="__nav_5_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2025
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2_3">
            <span class="md-nav__icon md-icon"></span>
            2025
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Cyber Apocalypse 2025
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_3_1" id="__nav_5_2_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            Cyber Apocalypse 2025
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2_3_1_2" id="__nav_5_2_3_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Twin Oracle
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Twin Oracle
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#twin-oracle" class="md-nav__link">
    <span class="md-ellipsis">
      Twin Oracle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-description" class="md-nav__link">
    <span class="md-ellipsis">
      Code / Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#challenge-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge Analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      Solution
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-code" class="md-nav__link">
    <span class="md-ellipsis">
      Final Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    <span class="md-ellipsis">
      Flag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authors" class="md-nav__link">
    <span class="md-ellipsis">
      Authors
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_2">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../Iran-Tech-Olympics-CTF-2025/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Iran Tech Olympics CTF 2025
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_3_2" id="__nav_5_2_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Iran Tech Olympics CTF 2025
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_2_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_3_2_2" id="__nav_5_2_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Iran-Tech-Olympics-CTF-2025/crypto/Techras/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Techras
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Iran-Tech-Olympics-CTF-2025/crypto/TechrasII/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Techras II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Iran-Tech-Olympics-CTF-2025/crypto/Gotam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gotam
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_2_3">
        
          
          <label class="md-nav__link" for="__nav_5_2_3_2_3" id="__nav_5_2_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    web
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Iran-Tech-Olympics-CTF-2025/web/IdolatressI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Idolatress I
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Iran-Tech-Olympics-CTF-2025/web/IdolatressII/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Idolatress II
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../Contact-Us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact Us
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../../About-Us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About Us
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#twin-oracle" class="md-nav__link">
    <span class="md-ellipsis">
      Twin Oracle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-description" class="md-nav__link">
    <span class="md-ellipsis">
      Code / Description
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#challenge-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Challenge Analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    <span class="md-ellipsis">
      Solution
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-code" class="md-nav__link">
    <span class="md-ellipsis">
      Final Code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flag" class="md-nav__link">
    <span class="md-ellipsis">
      Flag
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authors" class="md-nav__link">
    <span class="md-ellipsis">
      Authors
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Twin Oracle</h1>

<h2 id="twin-oracle">Twin Oracle</h2>
<table>
<thead>
<tr>
<th style="text-align: left;">Category</th>
<th style="text-align: left;">Difficulty</th>
<th style="text-align: left;">Score</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Crypto</td>
<td style="text-align: left;">Hard</td>
<td style="text-align: left;">1000</td>
</tr>
</tbody>
</table>
<h2 id="code-description">Code / Description</h2>
<div class="language-text highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span>
<span class="normal"><a href="#__codelineno-0-4">4</a></span>
<span class="normal"><a href="#__codelineno-0-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>A powerful artifactmeant to generate chaos yet uphold orderhas 
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a>revealed its flaw. A misplaced rune, an unintended pattern, an 
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a>oversight in the design. The one who understands the rhythm of its 
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4"></a>magic may predict its every move and use it against its creators. Will 
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5"></a>you be the one to claim its secrets?
</span></code></pre></div></td></tr></tbody></table></div>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-1-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-1-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-1-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-1-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-1-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-1-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-1-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-1-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-1-10">10</a></span>
<span class="normal"><a href="#__codelineno-1-11">11</a></span>
<span class="normal"><a href="#__codelineno-1-12">12</a></span>
<span class="normal"><a href="#__codelineno-1-13">13</a></span>
<span class="normal"><a href="#__codelineno-1-14">14</a></span>
<span class="normal"><a href="#__codelineno-1-15">15</a></span>
<span class="normal"><a href="#__codelineno-1-16">16</a></span>
<span class="normal"><a href="#__codelineno-1-17">17</a></span>
<span class="normal"><a href="#__codelineno-1-18">18</a></span>
<span class="normal"><a href="#__codelineno-1-19">19</a></span>
<span class="normal"><a href="#__codelineno-1-20">20</a></span>
<span class="normal"><a href="#__codelineno-1-21">21</a></span>
<span class="normal"><a href="#__codelineno-1-22">22</a></span>
<span class="normal"><a href="#__codelineno-1-23">23</a></span>
<span class="normal"><a href="#__codelineno-1-24">24</a></span>
<span class="normal"><a href="#__codelineno-1-25">25</a></span>
<span class="normal"><a href="#__codelineno-1-26">26</a></span>
<span class="normal"><a href="#__codelineno-1-27">27</a></span>
<span class="normal"><a href="#__codelineno-1-28">28</a></span>
<span class="normal"><a href="#__codelineno-1-29">29</a></span>
<span class="normal"><a href="#__codelineno-1-30">30</a></span>
<span class="normal"><a href="#__codelineno-1-31">31</a></span>
<span class="normal"><a href="#__codelineno-1-32">32</a></span>
<span class="normal"><a href="#__codelineno-1-33">33</a></span>
<span class="normal"><a href="#__codelineno-1-34">34</a></span>
<span class="normal"><a href="#__codelineno-1-35">35</a></span>
<span class="normal"><a href="#__codelineno-1-36">36</a></span>
<span class="normal"><a href="#__codelineno-1-37">37</a></span>
<span class="normal"><a href="#__codelineno-1-38">38</a></span>
<span class="normal"><a href="#__codelineno-1-39">39</a></span>
<span class="normal"><a href="#__codelineno-1-40">40</a></span>
<span class="normal"><a href="#__codelineno-1-41">41</a></span>
<span class="normal"><a href="#__codelineno-1-42">42</a></span>
<span class="normal"><a href="#__codelineno-1-43">43</a></span>
<span class="normal"><a href="#__codelineno-1-44">44</a></span>
<span class="normal"><a href="#__codelineno-1-45">45</a></span>
<span class="normal"><a href="#__codelineno-1-46">46</a></span>
<span class="normal"><a href="#__codelineno-1-47">47</a></span>
<span class="normal"><a href="#__codelineno-1-48">48</a></span>
<span class="normal"><a href="#__codelineno-1-49">49</a></span>
<span class="normal"><a href="#__codelineno-1-50">50</a></span>
<span class="normal"><a href="#__codelineno-1-51">51</a></span>
<span class="normal"><a href="#__codelineno-1-52">52</a></span>
<span class="normal"><a href="#__codelineno-1-53">53</a></span>
<span class="normal"><a href="#__codelineno-1-54">54</a></span>
<span class="normal"><a href="#__codelineno-1-55">55</a></span>
<span class="normal"><a href="#__codelineno-1-56">56</a></span>
<span class="normal"><a href="#__codelineno-1-57">57</a></span>
<span class="normal"><a href="#__codelineno-1-58">58</a></span>
<span class="normal"><a href="#__codelineno-1-59">59</a></span>
<span class="normal"><a href="#__codelineno-1-60">60</a></span>
<span class="normal"><a href="#__codelineno-1-61">61</a></span>
<span class="normal"><a href="#__codelineno-1-62">62</a></span>
<span class="normal"><a href="#__codelineno-1-63">63</a></span>
<span class="normal"><a href="#__codelineno-1-64">64</a></span>
<span class="normal"><a href="#__codelineno-1-65">65</a></span>
<span class="normal"><a href="#__codelineno-1-66">66</a></span>
<span class="normal"><a href="#__codelineno-1-67">67</a></span>
<span class="normal"><a href="#__codelineno-1-68">68</a></span>
<span class="normal"><a href="#__codelineno-1-69">69</a></span>
<span class="normal"><a href="#__codelineno-1-70">70</a></span>
<span class="normal"><a href="#__codelineno-1-71">71</a></span>
<span class="normal"><a href="#__codelineno-1-72">72</a></span>
<span class="normal"><a href="#__codelineno-1-73">73</a></span>
<span class="normal"><a href="#__codelineno-1-74">74</a></span>
<span class="normal"><a href="#__codelineno-1-75">75</a></span>
<span class="normal"><a href="#__codelineno-1-76">76</a></span>
<span class="normal"><a href="#__codelineno-1-77">77</a></span>
<span class="normal"><a href="#__codelineno-1-78">78</a></span>
<span class="normal"><a href="#__codelineno-1-79">79</a></span>
<span class="normal"><a href="#__codelineno-1-80">80</a></span>
<span class="normal"><a href="#__codelineno-1-81">81</a></span>
<span class="normal"><a href="#__codelineno-1-82">82</a></span>
<span class="normal"><a href="#__codelineno-1-83">83</a></span>
<span class="normal"><a href="#__codelineno-1-84">84</a></span>
<span class="normal"><a href="#__codelineno-1-85">85</a></span>
<span class="normal"><a href="#__codelineno-1-86">86</a></span>
<span class="normal"><a href="#__codelineno-1-87">87</a></span>
<span class="normal"><a href="#__codelineno-1-88">88</a></span>
<span class="normal"><a href="#__codelineno-1-89">89</a></span>
<span class="normal"><a href="#__codelineno-1-90">90</a></span>
<span class="normal"><a href="#__codelineno-1-91">91</a></span>
<span class="normal"><a href="#__codelineno-1-92">92</a></span>
<span class="normal"><a href="#__codelineno-1-93">93</a></span>
<span class="normal"><a href="#__codelineno-1-94">94</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.number</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="n">FLAG</span> <span class="o">=</span> <span class="n">bytes_to_long</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">'flag.txt'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="n">MENU</span> <span class="o">=</span> <span class="s1">'''</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="s1">The Seers await your command:</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7"></a>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="s1">1. Request Knowledge from the Elders</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="s1">2. Consult the Seers of the Obsidian Tower</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="s1">3. Depart from the Sanctum</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="s1">'''</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12"></a>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="k">class</span><span class="w"> </span><span class="nc">ChaosRelic</span><span class="p">:</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The Ancient Chaos Relic fuels the Seers' wisdom. Behold its power: M = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21"></a>
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24"></a>
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_bit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next_state</span><span class="p">()</span>
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_bit_from_state</span><span class="p">()</span>
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28"></a>
</span><span id="__span-1-29"><a id="__codelineno-1-29" name="__codelineno-1-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_bit_from_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-1-30"><a id="__codelineno-1-30" name="__codelineno-1-30"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span>
</span><span id="__span-1-31"><a id="__codelineno-1-31" name="__codelineno-1-31"></a>
</span><span id="__span-1-32"><a id="__codelineno-1-32" name="__codelineno-1-32"></a>
</span><span id="__span-1-33"><a id="__codelineno-1-33" name="__codelineno-1-33"></a><span class="k">class</span><span class="w"> </span><span class="nc">ObsidianSeers</span><span class="p">:</span>
</span><span id="__span-1-34"><a id="__codelineno-1-34" name="__codelineno-1-34"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relic</span><span class="p">):</span>
</span><span id="__span-1-35"><a id="__codelineno-1-35" name="__codelineno-1-35"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relic</span> <span class="o">=</span> <span class="n">relic</span>
</span><span id="__span-1-36"><a id="__codelineno-1-36" name="__codelineno-1-36"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span><span id="__span-1-37"><a id="__codelineno-1-37" name="__codelineno-1-37"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span><span id="__span-1-38"><a id="__codelineno-1-38" name="__codelineno-1-38"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span>
</span><span id="__span-1-39"><a id="__codelineno-1-39" name="__codelineno-1-39"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span> 
</span><span id="__span-1-40"><a id="__codelineno-1-40" name="__codelineno-1-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-1-41"><a id="__codelineno-1-41" name="__codelineno-1-41"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span>
</span><span id="__span-1-42"><a id="__codelineno-1-42" name="__codelineno-1-42"></a>
</span><span id="__span-1-43"><a id="__codelineno-1-43" name="__codelineno-1-43"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sacred_encryption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
</span><span id="__span-1-44"><a id="__codelineno-1-44" name="__codelineno-1-44"></a>        <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-1-45"><a id="__codelineno-1-45" name="__codelineno-1-45"></a>
</span><span id="__span-1-46"><a id="__codelineno-1-46" name="__codelineno-1-46"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sacred_decryption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-1-47"><a id="__codelineno-1-47" name="__codelineno-1-47"></a>        <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-1-48"><a id="__codelineno-1-48" name="__codelineno-1-48"></a>
</span><span id="__span-1-49"><a id="__codelineno-1-49" name="__codelineno-1-49"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">HighSeerVision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-1-50"><a id="__codelineno-1-50" name="__codelineno-1-50"></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sacred_decryption</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-1-51"><a id="__codelineno-1-51" name="__codelineno-1-51"></a>
</span><span id="__span-1-52"><a id="__codelineno-1-52" name="__codelineno-1-52"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">FateSeerWhisper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-1-53"><a id="__codelineno-1-53" name="__codelineno-1-53"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sacred_decryption</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
</span><span id="__span-1-54"><a id="__codelineno-1-54" name="__codelineno-1-54"></a>
</span><span id="__span-1-55"><a id="__codelineno-1-55" name="__codelineno-1-55"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">divine_prophecy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a_bit</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-1-56"><a id="__codelineno-1-56" name="__codelineno-1-56"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">FateSeerWhisper</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">if</span> <span class="n">a_bit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">HighSeerVision</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="__span-1-57"><a id="__codelineno-1-57" name="__codelineno-1-57"></a>
</span><span id="__span-1-58"><a id="__codelineno-1-58" name="__codelineno-1-58"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">consult_seers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-1-59"><a id="__codelineno-1-59" name="__codelineno-1-59"></a>        <span class="n">next_bit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relic</span><span class="o">.</span><span class="n">get_bit</span><span class="p">()</span>
</span><span id="__span-1-60"><a id="__codelineno-1-60" name="__codelineno-1-60"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divine_prophecy</span><span class="p">(</span><span class="n">next_bit</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="__span-1-61"><a id="__codelineno-1-61" name="__codelineno-1-61"></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="__span-1-62"><a id="__codelineno-1-62" name="__codelineno-1-62"></a>
</span><span id="__span-1-63"><a id="__codelineno-1-63" name="__codelineno-1-63"></a>
</span><span id="__span-1-64"><a id="__codelineno-1-64" name="__codelineno-1-64"></a>
</span><span id="__span-1-65"><a id="__codelineno-1-65" name="__codelineno-1-65"></a><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
</span><span id="__span-1-66"><a id="__codelineno-1-66" name="__codelineno-1-66"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">"You stand before the Seers of the Obsidian Tower. They alone hold the knowledge you seek."</span><span class="p">)</span>
</span><span id="__span-1-67"><a id="__codelineno-1-67" name="__codelineno-1-67"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">"But be warnedno force in Eldoria can break their will, and their wisdom is safeguarded by the power of the Chaos Relic."</span><span class="p">)</span>
</span><span id="__span-1-68"><a id="__codelineno-1-68" name="__codelineno-1-68"></a>    <span class="n">my_relic</span> <span class="o">=</span> <span class="n">ChaosRelic</span><span class="p">()</span>
</span><span id="__span-1-69"><a id="__codelineno-1-69" name="__codelineno-1-69"></a>    <span class="n">my_seers</span> <span class="o">=</span> <span class="n">ObsidianSeers</span><span class="p">(</span><span class="n">my_relic</span><span class="p">)</span>
</span><span id="__span-1-70"><a id="__codelineno-1-70" name="__codelineno-1-70"></a>    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-1-71"><a id="__codelineno-1-71" name="__codelineno-1-71"></a>
</span><span id="__span-1-72"><a id="__codelineno-1-72" name="__codelineno-1-72"></a>    <span class="k">while</span> <span class="n">counter</span> <span class="o">&lt;=</span> <span class="mi">1500</span><span class="p">:</span>
</span><span id="__span-1-73"><a id="__codelineno-1-73" name="__codelineno-1-73"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">MENU</span><span class="p">)</span>
</span><span id="__span-1-74"><a id="__codelineno-1-74" name="__codelineno-1-74"></a>        <span class="n">option</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">'&gt; '</span><span class="p">)</span>
</span><span id="__span-1-75"><a id="__codelineno-1-75" name="__codelineno-1-75"></a>
</span><span id="__span-1-76"><a id="__codelineno-1-76" name="__codelineno-1-76"></a>        <span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">'1'</span><span class="p">:</span>
</span><span id="__span-1-77"><a id="__codelineno-1-77" name="__codelineno-1-77"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The Elders grant you insight: n = </span><span class="si">{</span><span class="n">my_seers</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span><span id="__span-1-78"><a id="__codelineno-1-78" name="__codelineno-1-78"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The ancient script has been sealed: </span><span class="si">{</span><span class="n">my_seers</span><span class="o">.</span><span class="n">sacred_encryption</span><span class="p">(</span><span class="n">FLAG</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span><span id="__span-1-79"><a id="__codelineno-1-79" name="__codelineno-1-79"></a>        <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">'2'</span><span class="p">:</span>
</span><span id="__span-1-80"><a id="__codelineno-1-80" name="__codelineno-1-80"></a>            <span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">"Submit your encrypted scripture for the Seers' judgement: "</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="__span-1-81"><a id="__codelineno-1-81" name="__codelineno-1-81"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'The Seers whisper their answer: </span><span class="si">{</span><span class="n">my_seers</span><span class="o">.</span><span class="n">consult_seers</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</span><span id="__span-1-82"><a id="__codelineno-1-82" name="__codelineno-1-82"></a>        <span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">'3'</span><span class="p">:</span>
</span><span id="__span-1-83"><a id="__codelineno-1-83" name="__codelineno-1-83"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">"The doors of the Sanctum close behind you. The Seers watch in silence as you depart."</span><span class="p">)</span>
</span><span id="__span-1-84"><a id="__codelineno-1-84" name="__codelineno-1-84"></a>            <span class="k">break</span>
</span><span id="__span-1-85"><a id="__codelineno-1-85" name="__codelineno-1-85"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-1-86"><a id="__codelineno-1-86" name="__codelineno-1-86"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">"The Seers do not acknowledge your request."</span><span class="p">)</span>
</span><span id="__span-1-87"><a id="__codelineno-1-87" name="__codelineno-1-87"></a>            <span class="k">continue</span>
</span><span id="__span-1-88"><a id="__codelineno-1-88" name="__codelineno-1-88"></a>
</span><span id="__span-1-89"><a id="__codelineno-1-89" name="__codelineno-1-89"></a>        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-1-90"><a id="__codelineno-1-90" name="__codelineno-1-90"></a>
</span><span id="__span-1-91"><a id="__codelineno-1-91" name="__codelineno-1-91"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">"The stars fade, and the Seers retreat into silence. They shall speak no more tonight."</span><span class="p">)</span>
</span><span id="__span-1-92"><a id="__codelineno-1-92" name="__codelineno-1-92"></a>
</span><span id="__span-1-93"><a id="__codelineno-1-93" name="__codelineno-1-93"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
</span><span id="__span-1-94"><a id="__codelineno-1-94" name="__codelineno-1-94"></a>    <span class="n">main</span><span class="p">()</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h2 id="overview">Overview</h2>
<p>This challenge consists of several challenges</p>
<ol>
<li>Break a weakly implemented pseudorandom number generator (PRNG) to recover its seed</li>
<li>Attack two different RSA oracles using side-channel attacks with two different strategies</li>
<li>combine the two attacks to overcome the limit on the number of requests</li>
</ol>
<h2 id="challenge-analysis">Challenge Analysis</h2>
<p>First of all, let's analyze what the source code is doing.</p>
<p>It has two classes, <code>ChaosRelic</code> and <code>ObsidianSeers</code>.</p>
<ul>
<li>Class <code>ChaosRelic</code></li>
</ul>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ChaosRelic</span><span class="p">:</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x0</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The Ancient Chaos Relic fuels the Seers' wisdom. Behold its power: M = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_bit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">next_state</span><span class="p">()</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_bit_from_state</span><span class="p">()</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">extract_bit_from_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>This class looks like a random number generator that starts with an initial state <span class="arithmatex">\(x_0\)</span>, and every time the state changes like this</p>
<center>
$x \equiv x^2 \mod M$

$M = p*q$
</center>

<p>M is a 16-bit composite number which is the multiplication of two 8-bit primes <code>p,q.</code> Because M is in the form of <span class="arithmatex">\(p*q\)</span>, the x will not generate the entire group, and it will randomly generate some specific elements from the group and will cycle through them. This is quite similar to a random number generator. <strong>The M is public and is printed in the server banner below. But the x0 (the initial state) is unknown</strong></p>
<div class="language-text highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a>You stand before the Seers of the Obsidian Tower. They alone hold the knowledge you seek.
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>But be warnedno force in Eldoria can break their will, and their wisdom is safeguarded by the power of the Chaos Relic.
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a>The Ancient Chaos Relic fuels the Seers' wisdom. Behold its power: M = 47897
</span></code></pre></div></td></tr></tbody></table></div>
<ul>
<li>Class ObsidianSeers</li>
</ul>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ObsidianSeers</span><span class="p">:</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relic</span><span class="p">):</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">relic</span> <span class="o">=</span> <span class="n">relic</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">getPrime</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">q</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span> 
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">phi</span><span class="p">)</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sacred_encryption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a>        <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sacred_decryption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a>        <span class="k">return</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">HighSeerVision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18"></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sacred_decryption</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19"></a>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">FateSeerWhisper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sacred_decryption</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22"></a>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">divine_prophecy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a_bit</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">FateSeerWhisper</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">if</span> <span class="n">a_bit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">HighSeerVision</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25"></a>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">consult_seers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27"></a>        <span class="n">next_bit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relic</span><span class="o">.</span><span class="n">get_bit</span><span class="p">()</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28"></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divine_prophecy</span><span class="p">(</span><span class="n">next_bit</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29"></a>        <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>This class consists of implementing a 1024-bit RSA algorithm with a bunch of functions doing random stuff, which will be explored further.</p>
<p>The main section of the code offers us three choices:</p>
<div class="language-text highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a>The Seers await your command:
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a>1. Request Knowledge from the Elders
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a>2. Consult the Seers of the Obsidian Tower
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a>3. Depart from the Sanctum
</span></code></pre></div></td></tr></tbody></table></div>
<ul>
<li>The third option is nothing but to quit the program</li>
</ul>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">else</span><span class="p">:</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">"The Seers do not acknowledge your request."</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a>    <span class="k">continue</span>
</span></code></pre></div></td></tr></tbody></table></div>
<ul>
<li>By choosing the first one, the server will encrypt the flag and provide us with the public RSA modulus and the encrypted flag.</li>
</ul>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="k">if</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">'1'</span><span class="p">:</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The Elders grant you insight: n = </span><span class="si">{</span><span class="n">my_seers</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"The ancient script has been sealed: </span><span class="si">{</span><span class="n">my_seers</span><span class="o">.</span><span class="n">sacred_encryption</span><span class="p">(</span><span class="n">FLAG</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
<div class="language-text highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span>
<span class="normal"><a href="#__codelineno-8-7">7</a></span>
<span class="normal"><a href="#__codelineno-8-8">8</a></span>
<span class="normal"><a href="#__codelineno-8-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a>The Seers await your command:
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a>1. Request Knowledge from the Elders
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>2. Consult the Seers of the Obsidian Tower
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a>3. Depart from the Sanctum
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7"></a>&gt; 1
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8"></a>The Elders grant you insight: n = 84223988112329788643315126478856298001964465223902564550457158504322548445551982946374719278491504704656043776095798840695185826964713620325457868836976247617788774865906426812535522263573890128765265912164329380552122731810918647455745367204862041691840856883985327365103112116603011698927744483206062728177
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9"></a>The ancient script has been sealed: 47694792918067833618743337085074169616387122847854183880922228123790116865360288170088204064193033596887527465969348968814544104147445017166395413765181640814259263450597744776172288013953900133905995520194649135666797777071440078060478319519681570941988003198237202426022625737178644671710688961046463818717
</span></code></pre></div></td></tr></tbody></table></div>
<ul>
<li>By choosing the second option, the server expects an encrypted text in hex format from us and will call the <code>consult_seers</code> function with our input.</li>
</ul>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span>
<span class="normal"><a href="#__codelineno-9-2">2</a></span>
<span class="normal"><a href="#__codelineno-9-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">elif</span> <span class="n">option</span> <span class="o">==</span> <span class="s1">'2'</span><span class="p">:</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a>    <span class="n">ciphertext</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">"Submit your encrypted scripture for the Seers' judgement: "</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'The Seers whisper their answer: </span><span class="si">{</span><span class="n">my_seers</span><span class="o">.</span><span class="n">consult_seers</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>Let's see what happens inside the function.</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span>
<span class="normal"><a href="#__codelineno-10-3">3</a></span>
<span class="normal"><a href="#__codelineno-10-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">consult_seers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>    <span class="n">next_bit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relic</span><span class="o">.</span><span class="n">get_bit</span><span class="p">()</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divine_prophecy</span><span class="p">(</span><span class="n">next_bit</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>This function is called the <code>get_bit</code> function of the <code>relic</code> instance, which is an instance of the <code>ChaosRelic</code> class that was explored before. Here is the get_bit function</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_bit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">next_state</span><span class="p">()</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_bit_from_state</span><span class="p">()</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>It will simply call the next_state function, which will generate a new state from the previous state</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">next_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
<center>
$state \equiv state^2 \mod M$
</center>

<p>Back to the <code>get_bit</code> function, this function calls another function named <code>extract_bit_from_state,</code> which will return the LSB(Least Significant bit) of the state simply by taking the state to modulus 2</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span>
<span class="normal"><a href="#__codelineno-13-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_bit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">next_state</span><span class="p">()</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_bit_from_state</span><span class="p">()</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4"></a>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_bit_from_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>Let's return to the first function, <code>consult_seers.</code> Overall, the first line will generate a new state and return whether it is even or odd.</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">consult_seers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a>    <span class="n">next_bit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relic</span><span class="o">.</span><span class="n">get_bit</span><span class="p">()</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">divine_prophecy</span><span class="p">(</span><span class="n">next_bit</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a>    <span class="k">return</span> <span class="n">response</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>The next line will be called <code>divine_prophecy</code> with <code>next_bit</code> and the encrypted text <code>c,</code> which we have given to the server. Let's see what is happening inside the function</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span>
<span class="normal"><a href="#__codelineno-15-3">3</a></span>
<span class="normal"><a href="#__codelineno-15-4">4</a></span>
<span class="normal"><a href="#__codelineno-15-5">5</a></span>
<span class="normal"><a href="#__codelineno-15-6">6</a></span>
<span class="normal"><a href="#__codelineno-15-7">7</a></span>
<span class="normal"><a href="#__codelineno-15-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">HighSeerVision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sacred_decryption</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">FateSeerWhisper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sacred_decryption</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7"></a><span class="k">def</span><span class="w"> </span><span class="nf">divine_prophecy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a_bit</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">FateSeerWhisper</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">if</span> <span class="n">a_bit</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">HighSeerVision</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>The following line will be called <code>divine_prophecy</code> with <code>next_bit</code> and the encrypted text <code>c,</code> which we have given to the server. Let's see what is happening inside the function</p>
<p>The <code>FateSeerWhisper</code> will tell us whether the decryption of our provided cipher <code>c</code> is even or odd by taking to modulus 2. On the other hand, the <code>FateSeerWhisper</code> function will tell us whether the decryption of cipher message <code>c</code> is larger than half of the public modulus <code>n</code> or not.</p>
<p>In a big picture, we can illustrate the overall process using this code:</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">c</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">'hex format : '</span><span class="p">)</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="k">if</span> <span class="n">next_state</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># if state is even</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a>    <span class="k">return</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a>    <span class="c1"># returns 1 if decryption result ends in bit 1</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a>    <span class="c1"># else returns 0</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7"></a>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="k">else</span><span class="p">:</span> <span class="c1"># if state is odd</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9"></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">decrypt</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10"></a>    <span class="c1"># returns 1 if result of decryption is greater than n/2</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11"></a>    <span class="c1"># else returns 0</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>As an example</p>
<div class="language-text highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a>You stand before the Seers of the Obsidian Tower. They alone hold the knowledge you seek.
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a>But be warnedno force in Eldoria can break their will, and their wisdom is safeguarded by the power of the Chaos Relic.
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a>The Ancient Chaos Relic fuels the Seers' wisdom. Behold its power: M = 57121
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4"></a>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5"></a>The Seers await your command:
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6"></a>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7"></a>1. Request Knowledge from the Elders
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8"></a>2. Consult the Seers of the Obsidian Tower
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9"></a>3. Depart from the Sanctum
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10"></a>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11"></a>&gt; 2
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12"></a>Submit your encrypted scripture for the Seers' judgement: 1000
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13"></a>The Seers whisper their answer: 1
</span></code></pre></div></td></tr></tbody></table></div>
<h2 id="solution">Solution</h2>
<p>We can start explaining the solution now that we've realized what the code is doing. We are obviously facing an RSA oracle that expects ciphertext from the user and returns just a single bit (0 or 1). When the state is 0, the oracle returns the least significant bit of the decrypted text. There is already a known attack to recover an encrypted ciphertext from an RSA oracle that has such behaviors named <strong>Least Significant Bit Oracle Attack</strong>. There are already a lot of explanations about it around the internet, but I used <a href="https://github.com/ashutosh1206/Crypton/blob/master/RSA-encryption/Attack-LSBit-Oracle/README.md">this GitHub link</a> and also <a href="https://crypto.stackexchange.com/questions/11053/rsa-least-significant-bit-oracle-attack">this StackExchange link</a> which has demonstrated it with example and also the python code.</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="n">upper_limit</span> <span class="o">=</span> <span class="n">N</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="n">lower_limit</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="n">flag</span> <span class="o">=</span> <span class="s2">""</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="c1"># for 1024 bit N</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">1024</span><span class="p">:</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9"></a>    <span class="n">chosen_ct</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">((</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag_enc</span><span class="p">)</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span> <span class="o">%</span> <span class="n">N</span><span class="p">)</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">_decrypt</span><span class="p">(</span><span class="n">chosen_ct</span><span class="p">)</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11"></a>    <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12"></a>        <span class="n">upper_limit</span> <span class="o">=</span> <span class="p">(</span><span class="n">upper_limit</span> <span class="o">+</span> <span class="n">lower_limit</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13"></a>    <span class="k">elif</span> <span class="nb">ord</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14"></a>        <span class="n">lower_limit</span> <span class="o">=</span> <span class="p">(</span><span class="n">lower_limit</span> <span class="o">+</span> <span class="n">upper_limit</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16"></a>        <span class="n">throw</span> <span class="ne">Exception</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17"></a>    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18"></a>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="c1"># Decrypted ciphertext</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="nb">print</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">upper_limit</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>If you want a detailed explanation of how this attack works, read through those links, but let's describe the overall algorithm.</p>
<p>RSA has a fantastic property named <a href="https://en.wikipedia.org/wiki/Homomorphism">Homomorphism</a>. it means</p>
<center>
$f(x.y) = f(x).f(y)$
</center>

<p>Regarding RSA, imagine we have two messages: <span class="arithmatex">\(m_1\)</span> and <span class="arithmatex">\(m_2\)</span>. By definition, we can write:</p>
<center>
$E(m1*m2) = E(m1).E(m2)$
</center>

<p>Consider <span class="arithmatex">\(c\)</span> as the encryption of <span class="arithmatex">\(m=m1*m2\)</span> and <span class="arithmatex">\(c_i\)</span> as encryption of <span class="arithmatex">\(m_i\)</span> for <span class="arithmatex">\(i={1,2}\)</span>. We can write</p>
<center>
$c_1 \equiv (m_1)^e \mod n$

$c_2 \equiv (m_2)^e \mod n$

$c \equiv (m_1*m_2)^e = (m)^e \mod n$

$c \equiv c1 * c2 \mod n$
</center>

<p>Consider we want to decrypt the encrypted <code>flag</code>, which has been encrypted.</p>
<center>
$cf \equiv flag^e \mod N$
</center>

<p>Let's analyze this approach.</p>
<p>Encrypt <code>2</code> by the public key <code>n,e</code>, which is known, and multiply the result by cf modulus N and name the result ct</p>
<center>
$ct \equiv cf * 2^e \mod N$
</center>

<p>By Homomorphism, we know that once the <code>ct</code> is decrypted, it will result in <span class="arithmatex">\(2*flag\)</span>. We know that <code>n</code> is odd, and if <span class="arithmatex">\(2*flag\)</span> is less than <code>n</code>, it will result in <span class="arithmatex">\(2*flag\)</span>, which is definitely even and will return 0, but if <span class="arithmatex">\(2*flag\)</span> is greater than <code>n</code>, it will result in  <span class="arithmatex">\(2*flag - N\)</span> which is odd (even - odd = odd). The result will be </p>
<p>so we send <span class="arithmatex">\(2M\)</span> to the server:</p>
<ol>
<li>if the result is 0, then <span class="arithmatex">\(M &lt; N/2\)</span> </li>
<li>if the result is 1, then <span class="arithmatex">\(M &gt; N/2\)</span> </li>
</ol>
<p>Like <span class="arithmatex">\(2M\)</span>, let's see how the server reacts for <span class="arithmatex">\(4M\)</span></p>
<p>we send <span class="arithmatex">\(2M\)</span> then <span class="arithmatex">\(4M\)</span> and based upon server behaviour</p>
<ol>
<li>if the result is 0,0 then <span class="arithmatex">\(M &lt; N/2\)</span> and <span class="arithmatex">\(M &lt; N/4\)</span></li>
<li>if the result is 0,1 then <span class="arithmatex">\(M &lt; N/2\)</span> and <span class="arithmatex">\(M &gt; N/4\)</span></li>
<li>if the result is 1,0 then <span class="arithmatex">\(M &gt; N/2\)</span> and <span class="arithmatex">\(M &lt; 3N/4\)</span></li>
<li>if the result is 1,1 then <span class="arithmatex">\(M &gt; N/2\)</span> and <span class="arithmatex">\(M &gt; 3N/4\)</span></li>
</ol>
<p>If we continue to raise the coefficients like <span class="arithmatex">\(2M, 4M, 8M, 16M, ...\)</span>, we can limit the boundaries for M until we reach a specific value for M, which is actually the decrypted plaintext. It looks like some form of binary search to find M, and it will done in <span class="arithmatex">\(O(\log{n})\)</span>.</p>
<p>I recommend reading the StackExchange link, which has more details to explain.</p>
<p>Now we know we have an Oracle that is vulnerable to an LSB Oracle attack. But there is a problem. Getting back to the code, we have two different oracles. The other one has different behaviors, and our input flows through each of them based on the state, which is random and unknown. Therefore, to overcome this problem, we must first get the initial value of our random number generator. Due to its small size (16-bit), we can ensure that the cycling group generated by the state is not that large.</p>
<p>To find out the initial state, we need to give a carefully crafted input that will be directed to the second oracle, which checks whether the decryption result is greater than <span class="arithmatex">\(n/2\)</span>. Let's say we send this encrypted text to the server</p>
<center>
$cf \equiv (N-1)^e \mod N$
</center>

<p>After sending this input to the server, let's see what will happen in different states</p>
<center>
$cf^d \equiv N-1 \mod N$
</center>

<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="n">c</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">'hex format : '</span><span class="p">)</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="k">if</span> <span class="n">next_state</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># if state is even</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a>    <span class="k">return</span> <span class="n">decrypt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a>    <span class="c1"># returns 1 if decryption result ends in bit 1</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6"></a>    <span class="c1"># else returns 0</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7"></a>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="k">else</span><span class="p">:</span> <span class="c1"># if state is odd</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9"></a>    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">decrypt</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10"></a>    <span class="c1"># returns 1 if result of decryption is greater than n/2</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11"></a>    <span class="c1"># else returns 0</span>
</span></code></pre></div></td></tr></tbody></table></div>
<ol>
<li>if next_state() is even or (state % 2) is <code>0</code>: we know that N-1 is even so it will return <code>0</code> </li>
<li>if next_state() is odd or (state % 2) is <code>1</code>: we know that N-1 is greater than <span class="arithmatex">\(n/2\)</span> so it will return <code>1</code></li>
</ol>
<p>It is clear that this special input will return 0 if the state is even and 1 if the state ID is odd. </p>
<p>So we can get enough sequences of <span class="arithmatex">\({0,1}\)</span> from the server by this special input and determine the initial state. To do so, we will generate all possible states of every prime number between <span class="arithmatex">\(2^14\)</span> and <span class="arithmatex">\(2^15\)</span> (all 15-bit prime numbers) and check the received pattern from the oracle to match which number includes the same pattern. We will determine the initial state, which acts as the seed of our random number generator, and will finally break the weakly implemented PRNG</p>
<p>Here is the implemented code to recover the server's initial state:</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span>
<span class="normal"><a href="#__codelineno-20-17">17</a></span>
<span class="normal"><a href="#__codelineno-20-18">18</a></span>
<span class="normal"><a href="#__codelineno-20-19">19</a></span>
<span class="normal"><a href="#__codelineno-20-20">20</a></span>
<span class="normal"><a href="#__codelineno-20-21">21</a></span>
<span class="normal"><a href="#__codelineno-20-22">22</a></span>
<span class="normal"><a href="#__codelineno-20-23">23</a></span>
<span class="normal"><a href="#__codelineno-20-24">24</a></span>
<span class="normal"><a href="#__codelineno-20-25">25</a></span>
<span class="normal"><a href="#__codelineno-20-26">26</a></span>
<span class="normal"><a href="#__codelineno-20-27">27</a></span>
<span class="normal"><a href="#__codelineno-20-28">28</a></span>
<span class="normal"><a href="#__codelineno-20-29">29</a></span>
<span class="normal"><a href="#__codelineno-20-30">30</a></span>
<span class="normal"><a href="#__codelineno-20-31">31</a></span>
<span class="normal"><a href="#__codelineno-20-32">32</a></span>
<span class="normal"><a href="#__codelineno-20-33">33</a></span>
<span class="normal"><a href="#__codelineno-20-34">34</a></span>
<span class="normal"><a href="#__codelineno-20-35">35</a></span>
<span class="normal"><a href="#__codelineno-20-36">36</a></span>
<span class="normal"><a href="#__codelineno-20-37">37</a></span>
<span class="normal"><a href="#__codelineno-20-38">38</a></span>
<span class="normal"><a href="#__codelineno-20-39">39</a></span>
<span class="normal"><a href="#__codelineno-20-40">40</a></span>
<span class="normal"><a href="#__codelineno-20-41">41</a></span>
<span class="normal"><a href="#__codelineno-20-42">42</a></span>
<span class="normal"><a href="#__codelineno-20-43">43</a></span>
<span class="normal"><a href="#__codelineno-20-44">44</a></span>
<span class="normal"><a href="#__codelineno-20-45">45</a></span>
<span class="normal"><a href="#__codelineno-20-46">46</a></span>
<span class="normal"><a href="#__codelineno-20-47">47</a></span>
<span class="normal"><a href="#__codelineno-20-48">48</a></span>
<span class="normal"><a href="#__codelineno-20-49">49</a></span>
<span class="normal"><a href="#__codelineno-20-50">50</a></span>
<span class="normal"><a href="#__codelineno-20-51">51</a></span>
<span class="normal"><a href="#__codelineno-20-52">52</a></span>
<span class="normal"><a href="#__codelineno-20-53">53</a></span>
<span class="normal"><a href="#__codelineno-20-54">54</a></span>
<span class="normal"><a href="#__codelineno-20-55">55</a></span>
<span class="normal"><a href="#__codelineno-20-56">56</a></span>
<span class="normal"><a href="#__codelineno-20-57">57</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">gen_patterns</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2"></a>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3"></a>    <span class="n">patterns</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">15</span><span class="p">):</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5"></a>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6"></a>        <span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8"></a>            <span class="n">patterns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9"></a>            <span class="n">gens</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10"></a>            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11"></a>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12"></a>            <span class="k">while</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13"></a>                <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">gens</span><span class="p">):</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15"></a>                    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16"></a>                    <span class="n">gens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17"></a>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18"></a>                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19"></a>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20"></a>            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gens</span><span class="p">:</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21"></a>                <span class="n">patterns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22"></a>    <span class="k">return</span> <span class="n">patterns</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23"></a>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24"></a>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_state</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26"></a>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27"></a>    <span class="k">global</span> <span class="n">counter</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28"></a>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29"></a>    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30"></a>    <span class="n">copy</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31"></a>
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32"></a>
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33"></a>    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">patterns</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34"></a>
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35"></a>        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36"></a>        <span class="n">ct</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37"></a>        <span class="n">ct</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mh">0x10001</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38"></a>
</span><span id="__span-20-39"><a id="__codelineno-20-39" name="__codelineno-20-39"></a>        <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s1">'2</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</span><span id="__span-20-40"><a id="__codelineno-20-40" name="__codelineno-20-40"></a>        <span class="n">recvall</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
</span><span id="__span-20-41"><a id="__codelineno-20-41" name="__codelineno-20-41"></a>        <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">ct</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span><span id="__span-20-42"><a id="__codelineno-20-42" name="__codelineno-20-42"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">recvall</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="__span-20-43"><a id="__codelineno-20-43" name="__codelineno-20-43"></a>
</span><span id="__span-20-44"><a id="__codelineno-20-44" name="__codelineno-20-44"></a>        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-20-45"><a id="__codelineno-20-45" name="__codelineno-20-45"></a>        <span class="n">parity</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'The Seers whisper their answer: ([0-1])'</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-20-46"><a id="__codelineno-20-46" name="__codelineno-20-46"></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">copy</span><span class="p">:</span>
</span><span id="__span-20-47"><a id="__codelineno-20-47" name="__codelineno-20-47"></a>            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patterns</span> <span class="ow">and</span> <span class="n">copy</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">copy</span><span class="p">[</span><span class="n">p</span><span class="p">])]</span> <span class="o">!=</span> <span class="n">parity</span><span class="p">:</span>
</span><span id="__span-20-48"><a id="__codelineno-20-48" name="__codelineno-20-48"></a>                <span class="n">patterns</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="__span-20-49"><a id="__codelineno-20-49" name="__codelineno-20-49"></a>
</span><span id="__span-20-50"><a id="__codelineno-20-50" name="__codelineno-20-50"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">patterns</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-20-51"><a id="__codelineno-20-51" name="__codelineno-20-51"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="__span-20-52"><a id="__codelineno-20-52" name="__codelineno-20-52"></a>
</span><span id="__span-20-53"><a id="__codelineno-20-53" name="__codelineno-20-53"></a>
</span><span id="__span-20-54"><a id="__codelineno-20-54" name="__codelineno-20-54"></a><span class="n">patterns</span> <span class="o">=</span> <span class="n">gen_patterns</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</span><span id="__span-20-55"><a id="__codelineno-20-55" name="__codelineno-20-55"></a><span class="n">states</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">get_state</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="__span-20-56"><a id="__codelineno-20-56" name="__codelineno-20-56"></a><span class="nb">print</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
</span><span id="__span-20-57"><a id="__codelineno-20-57" name="__codelineno-20-57"></a><span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>Now that we have the initial state, we can predict the next state and determine which oracle our input will flow to send our crafted input for the LSB oracle attack if the state is even. Otherwise, we will send an empty input to avoid the second oracle. But there is another problem. We need approximately 1024 requests to make the attack (because it performs in <span class="arithmatex">\(Log_n\)</span> and the <span class="arithmatex">\(n\)</span> is 1024 bit), but there is a counter that limits the total number of requests to 1500</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="k">while</span> <span class="n">counter</span> <span class="o">&lt;=</span> <span class="mi">1500</span><span class="p">:</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>Based on the state value, around half of our requests will go to the desired oracle, which results in sending about 750 requests. The remaining requests will not be accepted by the server anymore. Therefore, the decryption process will remain unfinished, and we have to start from the beginning.</p>
<p>To overcome this challenge, based on the challenge name (twin oracle), we should utilize both oracles to limit our boundaries of n to recover m, which is the flag. After searching for a noticeable amount of time, I came up with exploiting the second oracle's behavior to decrypt the flag. Although I could not find a direct reference to explain this attack, we can observe and illustrate it as an example.</p>
<p>According to the code
</p><div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">decrypt</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div><p></p>
<p>if we send and encrypted text <span class="arithmatex">\(C\)</span></p>
<center>
$C \equiv M^e \mod N$
</center>

<p>it will return <code>0</code> if the decrypted message is lower than <span class="arithmatex">\(n/2\)</span>; otherwise it will return <code>1</code>. In another word,</p>
<center>
$M &gt; N/2$

$2*M &gt; N$
</center>

<p>We can use a similar approach to LSB oracle attack and start to multiply the M, which we want to decrypt by exponents of 2 and send it to the server to limit the bondaries of N which shows what ranges of N, M might be at.</p>
<p>As an example:</p>
<ol>
<li>Let's say we send <span class="arithmatex">\(C \equiv (M)^e \mod N\)</span>.<ul>
<li>if server returns 0 is means <span class="arithmatex">\(M&lt;N/2\)</span> otherwise <span class="arithmatex">\(M &gt; N/2\)</span>.</li>
</ul>
</li>
<li>Let's say we send <span class="arithmatex">\(C \equiv (2*M)^e \mod N\)</span>.<ul>
<li>if the server returns 0 it means <span class="arithmatex">\(M&lt;N/4\)</span> otherwise <span class="arithmatex">\(M&gt;N/4\)</span></li>
</ul>
</li>
</ol>
<p>Now consider we send a message like:</p>
<center>
$C_i \equiv (2^i*M)^e \mod N$
</center>

<ol>
<li>if the answer is <code>0</code>, it means<ul>
<li><span class="arithmatex">\(M &lt; N/{2^{i+1}}\)</span> and we should lower the upper bound to <span class="arithmatex">\({L+H}/2\)</span></li>
</ul>
</li>
<li>if the answer is <code>1</code>, it means<ul>
<li><span class="arithmatex">\(M &gt; N/{2^{i+1}}\)</span> and we should rise the lower bound to <span class="arithmatex">\({L+H}/2\)</span></li>
</ul>
</li>
</ol>
<p>This also looks like a binary search to limit the boundaries until we reach the exact value for M.  </p>
<center>
$H-L &lt; 1$
</center>

<p>The code to illustrate this attack is similar to the previous one, with a slight difference: the index of <code>i</code> should start from 0 instead of 1 because the server already has a <code>2</code> coefficient.</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span>
<span class="normal"><a href="#__codelineno-23-11">11</a></span>
<span class="normal"><a href="#__codelineno-23-12">12</a></span>
<span class="normal"><a href="#__codelineno-23-13">13</a></span>
<span class="normal"><a href="#__codelineno-23-14">14</a></span>
<span class="normal"><a href="#__codelineno-23-15">15</a></span>
<span class="normal"><a href="#__codelineno-23-16">16</a></span>
<span class="normal"><a href="#__codelineno-23-17">17</a></span>
<span class="normal"><a href="#__codelineno-23-18">18</a></span>
<span class="normal"><a href="#__codelineno-23-19">19</a></span>
<span class="normal"><a href="#__codelineno-23-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="n">e</span> <span class="o">=</span> <span class="mi">65537</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="n">upper_limit</span> <span class="o">=</span> <span class="n">N</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="n">lower_limit</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="n">flag</span> <span class="o">=</span> <span class="s2">""</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="c1"># for 1024 bit N</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">1024</span><span class="p">:</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9"></a>    <span class="n">chosen_ct</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">((</span><span class="n">bytes_to_long</span><span class="p">(</span><span class="n">flag_enc</span><span class="p">)</span><span class="o">*</span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span> <span class="o">%</span> <span class="n">N</span><span class="p">)</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10"></a>    <span class="n">output</span> <span class="o">=</span> <span class="n">_decrypt</span><span class="p">(</span><span class="n">chosen_ct</span><span class="p">)</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11"></a>    <span class="k">if</span> <span class="nb">ord</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12"></a>        <span class="n">upper_limit</span> <span class="o">=</span> <span class="p">(</span><span class="n">upper_limit</span> <span class="o">+</span> <span class="n">lower_limit</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13"></a>    <span class="k">elif</span> <span class="nb">ord</span><span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14"></a>        <span class="n">lower_limit</span> <span class="o">=</span> <span class="p">(</span><span class="n">lower_limit</span> <span class="o">+</span> <span class="n">upper_limit</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16"></a>        <span class="n">throw</span> <span class="ne">Exception</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17"></a>    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18"></a>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19"></a><span class="c1"># Decrypted ciphertext</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20"></a><span class="nb">print</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">upper_limit</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>Since we have to use both Oracles simultaneously without exceeding the limit(1500 requests), we should somehow combine these two algorithms. The algorithms are exactly the same except for the starting index. However, for the operation on upper and lower bounds, I was not sure how to combine these two algorithms. Should I choose two different sets of bounds, or was one enough? After choosing one pair, it worked.</p>
<p>So here is the code to attack the oracles</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span>
<span class="normal"><a href="#__codelineno-24-12">12</a></span>
<span class="normal"><a href="#__codelineno-24-13">13</a></span>
<span class="normal"><a href="#__codelineno-24-14">14</a></span>
<span class="normal"><a href="#__codelineno-24-15">15</a></span>
<span class="normal"><a href="#__codelineno-24-16">16</a></span>
<span class="normal"><a href="#__codelineno-24-17">17</a></span>
<span class="normal"><a href="#__codelineno-24-18">18</a></span>
<span class="normal"><a href="#__codelineno-24-19">19</a></span>
<span class="normal"><a href="#__codelineno-24-20">20</a></span>
<span class="normal"><a href="#__codelineno-24-21">21</a></span>
<span class="normal"><a href="#__codelineno-24-22">22</a></span>
<span class="normal"><a href="#__codelineno-24-23">23</a></span>
<span class="normal"><a href="#__codelineno-24-24">24</a></span>
<span class="normal"><a href="#__codelineno-24-25">25</a></span>
<span class="normal"><a href="#__codelineno-24-26">26</a></span>
<span class="normal"><a href="#__codelineno-24-27">27</a></span>
<span class="normal"><a href="#__codelineno-24-28">28</a></span>
<span class="normal"><a href="#__codelineno-24-29">29</a></span>
<span class="normal"><a href="#__codelineno-24-30">30</a></span>
<span class="normal"><a href="#__codelineno-24-31">31</a></span>
<span class="normal"><a href="#__codelineno-24-32">32</a></span>
<span class="normal"><a href="#__codelineno-24-33">33</a></span>
<span class="normal"><a href="#__codelineno-24-34">34</a></span>
<span class="normal"><a href="#__codelineno-24-35">35</a></span>
<span class="normal"><a href="#__codelineno-24-36">36</a></span>
<span class="normal"><a href="#__codelineno-24-37">37</a></span>
<span class="normal"><a href="#__codelineno-24-38">38</a></span>
<span class="normal"><a href="#__codelineno-24-39">39</a></span>
<span class="normal"><a href="#__codelineno-24-40">40</a></span>
<span class="normal"><a href="#__codelineno-24-41">41</a></span>
<span class="normal"><a href="#__codelineno-24-42">42</a></span>
<span class="normal"><a href="#__codelineno-24-43">43</a></span>
<span class="normal"><a href="#__codelineno-24-44">44</a></span>
<span class="normal"><a href="#__codelineno-24-45">45</a></span>
<span class="normal"><a href="#__codelineno-24-46">46</a></span>
<span class="normal"><a href="#__codelineno-24-47">47</a></span>
<span class="normal"><a href="#__codelineno-24-48">48</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">oracle_attack</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">oracle</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3"></a>    <span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4"></a>    <span class="n">high</span> <span class="o">=</span> <span class="n">N</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5"></a>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6"></a>    <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">patterns</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9"></a>        <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10"></a>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11"></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12"></a>    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13"></a>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14"></a>    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">high</span><span class="o">-</span><span class="n">low</span><span class="p">):</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15"></a>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'counter : </span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17"></a>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18"></a>        <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19"></a>        <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20"></a>            <span class="n">po</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21"></a>            <span class="n">ct</span> <span class="o">=</span> <span class="p">(</span><span class="n">po</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22"></a>            <span class="n">parity</span> <span class="o">=</span> <span class="n">oracle</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23"></a>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24"></a>            <span class="k">if</span> <span class="n">parity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25"></a>                <span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span><span class="o">+</span><span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27"></a>                <span class="n">low</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span><span class="o">+</span><span class="n">high</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28"></a>
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29"></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30"></a>            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31"></a>
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33"></a>            <span class="n">po</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34"></a>            <span class="n">ct</span> <span class="o">=</span> <span class="p">(</span><span class="n">po</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35"></a>            <span class="n">parity</span> <span class="o">=</span> <span class="n">oracle</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>
</span><span id="__span-24-36"><a id="__codelineno-24-36" name="__codelineno-24-36"></a>
</span><span id="__span-24-37"><a id="__codelineno-24-37" name="__codelineno-24-37"></a>            <span class="k">if</span> <span class="n">parity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-24-38"><a id="__codelineno-24-38" name="__codelineno-24-38"></a>                <span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span><span class="o">+</span><span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="__span-24-39"><a id="__codelineno-24-39" name="__codelineno-24-39"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-24-40"><a id="__codelineno-24-40" name="__codelineno-24-40"></a>                <span class="n">low</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span><span class="o">+</span><span class="n">high</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="__span-24-41"><a id="__codelineno-24-41" name="__codelineno-24-41"></a>
</span><span id="__span-24-42"><a id="__codelineno-24-42" name="__codelineno-24-42"></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-24-43"><a id="__codelineno-24-43" name="__codelineno-24-43"></a>            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-24-44"><a id="__codelineno-24-44" name="__codelineno-24-44"></a>
</span><span id="__span-24-45"><a id="__codelineno-24-45" name="__codelineno-24-45"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">high</span><span class="p">)</span>
</span><span id="__span-24-46"><a id="__codelineno-24-46" name="__codelineno-24-46"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
</span><span id="__span-24-47"><a id="__codelineno-24-47" name="__codelineno-24-47"></a>
</span><span id="__span-24-48"><a id="__codelineno-24-48" name="__codelineno-24-48"></a>    <span class="k">return</span> <span class="n">low</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>Notice that we should get the current state before attacking the oracles by repeating the random number generator operation.</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">patterns</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4"></a>    <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h2 id="final-code">Final Code</h2>
<p>The final code to automate the process:</p>
<div class="language-py highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">  1</a></span>
<span class="normal"><a href="#__codelineno-26-2">  2</a></span>
<span class="normal"><a href="#__codelineno-26-3">  3</a></span>
<span class="normal"><a href="#__codelineno-26-4">  4</a></span>
<span class="normal"><a href="#__codelineno-26-5">  5</a></span>
<span class="normal"><a href="#__codelineno-26-6">  6</a></span>
<span class="normal"><a href="#__codelineno-26-7">  7</a></span>
<span class="normal"><a href="#__codelineno-26-8">  8</a></span>
<span class="normal"><a href="#__codelineno-26-9">  9</a></span>
<span class="normal"><a href="#__codelineno-26-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-26-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-26-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-26-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-26-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-26-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-26-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-26-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-26-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-26-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-26-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-26-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-26-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-26-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-26-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-26-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-26-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-26-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-26-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-26-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-26-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-26-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-26-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-26-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-26-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-26-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-26-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-26-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-26-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-26-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-26-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-26-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-26-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-26-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-26-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-26-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-26-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-26-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-26-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-26-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-26-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-26-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-26-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-26-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-26-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-26-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-26-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-26-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-26-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-26-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-26-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-26-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-26-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-26-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-26-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-26-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-26-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-26-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-26-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-26-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-26-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-26-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-26-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-26-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-26-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-26-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-26-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-26-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-26-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-26-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-26-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-26-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-26-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-26-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-26-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-26-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-26-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-26-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-26-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-26-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-26-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-26-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-26-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-26-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-26-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-26-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-26-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-26-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-26-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-26-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-26-100">100</a></span>
<span class="normal"><a href="#__codelineno-26-101">101</a></span>
<span class="normal"><a href="#__codelineno-26-102">102</a></span>
<span class="normal"><a href="#__codelineno-26-103">103</a></span>
<span class="normal"><a href="#__codelineno-26-104">104</a></span>
<span class="normal"><a href="#__codelineno-26-105">105</a></span>
<span class="normal"><a href="#__codelineno-26-106">106</a></span>
<span class="normal"><a href="#__codelineno-26-107">107</a></span>
<span class="normal"><a href="#__codelineno-26-108">108</a></span>
<span class="normal"><a href="#__codelineno-26-109">109</a></span>
<span class="normal"><a href="#__codelineno-26-110">110</a></span>
<span class="normal"><a href="#__codelineno-26-111">111</a></span>
<span class="normal"><a href="#__codelineno-26-112">112</a></span>
<span class="normal"><a href="#__codelineno-26-113">113</a></span>
<span class="normal"><a href="#__codelineno-26-114">114</a></span>
<span class="normal"><a href="#__codelineno-26-115">115</a></span>
<span class="normal"><a href="#__codelineno-26-116">116</a></span>
<span class="normal"><a href="#__codelineno-26-117">117</a></span>
<span class="normal"><a href="#__codelineno-26-118">118</a></span>
<span class="normal"><a href="#__codelineno-26-119">119</a></span>
<span class="normal"><a href="#__codelineno-26-120">120</a></span>
<span class="normal"><a href="#__codelineno-26-121">121</a></span>
<span class="normal"><a href="#__codelineno-26-122">122</a></span>
<span class="normal"><a href="#__codelineno-26-123">123</a></span>
<span class="normal"><a href="#__codelineno-26-124">124</a></span>
<span class="normal"><a href="#__codelineno-26-125">125</a></span>
<span class="normal"><a href="#__codelineno-26-126">126</a></span>
<span class="normal"><a href="#__codelineno-26-127">127</a></span>
<span class="normal"><a href="#__codelineno-26-128">128</a></span>
<span class="normal"><a href="#__codelineno-26-129">129</a></span>
<span class="normal"><a href="#__codelineno-26-130">130</a></span>
<span class="normal"><a href="#__codelineno-26-131">131</a></span>
<span class="normal"><a href="#__codelineno-26-132">132</a></span>
<span class="normal"><a href="#__codelineno-26-133">133</a></span>
<span class="normal"><a href="#__codelineno-26-134">134</a></span>
<span class="normal"><a href="#__codelineno-26-135">135</a></span>
<span class="normal"><a href="#__codelineno-26-136">136</a></span>
<span class="normal"><a href="#__codelineno-26-137">137</a></span>
<span class="normal"><a href="#__codelineno-26-138">138</a></span>
<span class="normal"><a href="#__codelineno-26-139">139</a></span>
<span class="normal"><a href="#__codelineno-26-140">140</a></span>
<span class="normal"><a href="#__codelineno-26-141">141</a></span>
<span class="normal"><a href="#__codelineno-26-142">142</a></span>
<span class="normal"><a href="#__codelineno-26-143">143</a></span>
<span class="normal"><a href="#__codelineno-26-144">144</a></span>
<span class="normal"><a href="#__codelineno-26-145">145</a></span>
<span class="normal"><a href="#__codelineno-26-146">146</a></span>
<span class="normal"><a href="#__codelineno-26-147">147</a></span>
<span class="normal"><a href="#__codelineno-26-148">148</a></span>
<span class="normal"><a href="#__codelineno-26-149">149</a></span>
<span class="normal"><a href="#__codelineno-26-150">150</a></span>
<span class="normal"><a href="#__codelineno-26-151">151</a></span>
<span class="normal"><a href="#__codelineno-26-152">152</a></span>
<span class="normal"><a href="#__codelineno-26-153">153</a></span>
<span class="normal"><a href="#__codelineno-26-154">154</a></span>
<span class="normal"><a href="#__codelineno-26-155">155</a></span>
<span class="normal"><a href="#__codelineno-26-156">156</a></span>
<span class="normal"><a href="#__codelineno-26-157">157</a></span>
<span class="normal"><a href="#__codelineno-26-158">158</a></span>
<span class="normal"><a href="#__codelineno-26-159">159</a></span>
<span class="normal"><a href="#__codelineno-26-160">160</a></span>
<span class="normal"><a href="#__codelineno-26-161">161</a></span>
<span class="normal"><a href="#__codelineno-26-162">162</a></span>
<span class="normal"><a href="#__codelineno-26-163">163</a></span>
<span class="normal"><a href="#__codelineno-26-164">164</a></span>
<span class="normal"><a href="#__codelineno-26-165">165</a></span>
<span class="normal"><a href="#__codelineno-26-166">166</a></span>
<span class="normal"><a href="#__codelineno-26-167">167</a></span>
<span class="normal"><a href="#__codelineno-26-168">168</a></span>
<span class="normal"><a href="#__codelineno-26-169">169</a></span>
<span class="normal"><a href="#__codelineno-26-170">170</a></span>
<span class="normal"><a href="#__codelineno-26-171">171</a></span>
<span class="normal"><a href="#__codelineno-26-172">172</a></span>
<span class="normal"><a href="#__codelineno-26-173">173</a></span>
<span class="normal"><a href="#__codelineno-26-174">174</a></span>
<span class="normal"><a href="#__codelineno-26-175">175</a></span>
<span class="normal"><a href="#__codelineno-26-176">176</a></span>
<span class="normal"><a href="#__codelineno-26-177">177</a></span>
<span class="normal"><a href="#__codelineno-26-178">178</a></span>
<span class="normal"><a href="#__codelineno-26-179">179</a></span>
<span class="normal"><a href="#__codelineno-26-180">180</a></span>
<span class="normal"><a href="#__codelineno-26-181">181</a></span>
<span class="normal"><a href="#__codelineno-26-182">182</a></span>
<span class="normal"><a href="#__codelineno-26-183">183</a></span>
<span class="normal"><a href="#__codelineno-26-184">184</a></span>
<span class="normal"><a href="#__codelineno-26-185">185</a></span>
<span class="normal"><a href="#__codelineno-26-186">186</a></span>
<span class="normal"><a href="#__codelineno-26-187">187</a></span>
<span class="normal"><a href="#__codelineno-26-188">188</a></span>
<span class="normal"><a href="#__codelineno-26-189">189</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">time</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">Crypto.Util.number</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="c1"># host = '83.136.254.73'</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="c1"># port = 57362</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8"></a>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="n">host</span> <span class="o">=</span> <span class="s1">'127.0.0.1'</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="n">port</span> <span class="o">=</span> <span class="mi">50001</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11"></a>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
</span><span id="__span-26-14"><a id="__codelineno-26-14" name="__codelineno-26-14"></a>
</span><span id="__span-26-15"><a id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-26-16"><a id="__codelineno-26-16" name="__codelineno-26-16"></a>
</span><span id="__span-26-17"><a id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="k">def</span><span class="w"> </span><span class="nf">recvall</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">end_marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="__span-26-18"><a id="__codelineno-26-18" name="__codelineno-26-18"></a>
</span><span id="__span-26-19"><a id="__codelineno-26-19" name="__codelineno-26-19"></a>    <span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">""</span>
</span><span id="__span-26-20"><a id="__codelineno-26-20" name="__codelineno-26-20"></a>    <span class="n">sock</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span>
</span><span id="__span-26-21"><a id="__codelineno-26-21" name="__codelineno-26-21"></a>
</span><span id="__span-26-22"><a id="__codelineno-26-22" name="__codelineno-26-22"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-26-23"><a id="__codelineno-26-23" name="__codelineno-26-23"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-26-24"><a id="__codelineno-26-24" name="__codelineno-26-24"></a>            <span class="n">chunk</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">buffer_size</span><span class="p">)</span>
</span><span id="__span-26-25"><a id="__codelineno-26-25" name="__codelineno-26-25"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
</span><span id="__span-26-26"><a id="__codelineno-26-26" name="__codelineno-26-26"></a>                <span class="k">break</span>
</span><span id="__span-26-27"><a id="__codelineno-26-27" name="__codelineno-26-27"></a>
</span><span id="__span-26-28"><a id="__codelineno-26-28" name="__codelineno-26-28"></a>            <span class="n">data</span> <span class="o">+=</span> <span class="n">chunk</span>
</span><span id="__span-26-29"><a id="__codelineno-26-29" name="__codelineno-26-29"></a>            <span class="k">if</span> <span class="n">end_marker</span> <span class="ow">and</span> <span class="n">end_marker</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span><span id="__span-26-30"><a id="__codelineno-26-30" name="__codelineno-26-30"></a>                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">end_marker</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-26-31"><a id="__codelineno-26-31" name="__codelineno-26-31"></a>                <span class="k">break</span>
</span><span id="__span-26-32"><a id="__codelineno-26-32" name="__codelineno-26-32"></a>
</span><span id="__span-26-33"><a id="__codelineno-26-33" name="__codelineno-26-33"></a>    <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
</span><span id="__span-26-34"><a id="__codelineno-26-34" name="__codelineno-26-34"></a>        <span class="k">pass</span>
</span><span id="__span-26-35"><a id="__codelineno-26-35" name="__codelineno-26-35"></a>
</span><span id="__span-26-36"><a id="__codelineno-26-36" name="__codelineno-26-36"></a>    <span class="k">return</span> <span class="n">data</span>
</span><span id="__span-26-37"><a id="__codelineno-26-37" name="__codelineno-26-37"></a>
</span><span id="__span-26-38"><a id="__codelineno-26-38" name="__codelineno-26-38"></a><span class="k">def</span><span class="w"> </span><span class="nf">gen_patterns</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
</span><span id="__span-26-39"><a id="__codelineno-26-39" name="__codelineno-26-39"></a>
</span><span id="__span-26-40"><a id="__codelineno-26-40" name="__codelineno-26-40"></a>    <span class="n">patterns</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="__span-26-41"><a id="__codelineno-26-41" name="__codelineno-26-41"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">15</span><span class="p">):</span>
</span><span id="__span-26-42"><a id="__codelineno-26-42" name="__codelineno-26-42"></a>
</span><span id="__span-26-43"><a id="__codelineno-26-43" name="__codelineno-26-43"></a>        <span class="k">if</span> <span class="n">isPrime</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span><span id="__span-26-44"><a id="__codelineno-26-44" name="__codelineno-26-44"></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="__span-26-45"><a id="__codelineno-26-45" name="__codelineno-26-45"></a>            <span class="n">patterns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-26-46"><a id="__codelineno-26-46" name="__codelineno-26-46"></a>            <span class="n">gens</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
</span><span id="__span-26-47"><a id="__codelineno-26-47" name="__codelineno-26-47"></a>            <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-26-48"><a id="__codelineno-26-48" name="__codelineno-26-48"></a>
</span><span id="__span-26-49"><a id="__codelineno-26-49" name="__codelineno-26-49"></a>            <span class="k">while</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
</span><span id="__span-26-50"><a id="__codelineno-26-50" name="__codelineno-26-50"></a>                <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span><span id="__span-26-51"><a id="__codelineno-26-51" name="__codelineno-26-51"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">gens</span><span class="p">):</span>
</span><span id="__span-26-52"><a id="__codelineno-26-52" name="__codelineno-26-52"></a>                    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-26-53"><a id="__codelineno-26-53" name="__codelineno-26-53"></a>                    <span class="n">gens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-26-54"><a id="__codelineno-26-54" name="__codelineno-26-54"></a>
</span><span id="__span-26-55"><a id="__codelineno-26-55" name="__codelineno-26-55"></a>                <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-26-56"><a id="__codelineno-26-56" name="__codelineno-26-56"></a>
</span><span id="__span-26-57"><a id="__codelineno-26-57" name="__codelineno-26-57"></a>            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gens</span><span class="p">:</span>
</span><span id="__span-26-58"><a id="__codelineno-26-58" name="__codelineno-26-58"></a>                <span class="n">patterns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="__span-26-59"><a id="__codelineno-26-59" name="__codelineno-26-59"></a>    <span class="k">return</span> <span class="n">patterns</span>
</span><span id="__span-26-60"><a id="__codelineno-26-60" name="__codelineno-26-60"></a>
</span><span id="__span-26-61"><a id="__codelineno-26-61" name="__codelineno-26-61"></a>
</span><span id="__span-26-62"><a id="__codelineno-26-62" name="__codelineno-26-62"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_state</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span><span id="__span-26-63"><a id="__codelineno-26-63" name="__codelineno-26-63"></a>
</span><span id="__span-26-64"><a id="__codelineno-26-64" name="__codelineno-26-64"></a>    <span class="k">global</span> <span class="n">counter</span>
</span><span id="__span-26-65"><a id="__codelineno-26-65" name="__codelineno-26-65"></a>
</span><span id="__span-26-66"><a id="__codelineno-26-66" name="__codelineno-26-66"></a>    <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-26-67"><a id="__codelineno-26-67" name="__codelineno-26-67"></a>    <span class="c1"># reverse_dict = {tuple(v): k for k, v in patterns.items()}</span>
</span><span id="__span-26-68"><a id="__codelineno-26-68" name="__codelineno-26-68"></a>    <span class="n">copy</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="__span-26-69"><a id="__codelineno-26-69" name="__codelineno-26-69"></a>
</span><span id="__span-26-70"><a id="__codelineno-26-70" name="__codelineno-26-70"></a>
</span><span id="__span-26-71"><a id="__codelineno-26-71" name="__codelineno-26-71"></a>    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">patterns</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">counter</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span>
</span><span id="__span-26-72"><a id="__codelineno-26-72" name="__codelineno-26-72"></a>
</span><span id="__span-26-73"><a id="__codelineno-26-73" name="__codelineno-26-73"></a>        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-26-74"><a id="__codelineno-26-74" name="__codelineno-26-74"></a>        <span class="n">ct</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-26-75"><a id="__codelineno-26-75" name="__codelineno-26-75"></a>        <span class="n">ct</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">((</span><span class="n">n</span><span class="o">//</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="mi">80</span><span class="p">,</span> <span class="mh">0x10001</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-26-76"><a id="__codelineno-26-76" name="__codelineno-26-76"></a>
</span><span id="__span-26-77"><a id="__codelineno-26-77" name="__codelineno-26-77"></a>        <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s1">'2</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</span><span id="__span-26-78"><a id="__codelineno-26-78" name="__codelineno-26-78"></a>        <span class="n">recvall</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
</span><span id="__span-26-79"><a id="__codelineno-26-79" name="__codelineno-26-79"></a>        <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">ct</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span><span id="__span-26-80"><a id="__codelineno-26-80" name="__codelineno-26-80"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">recvall</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="__span-26-81"><a id="__codelineno-26-81" name="__codelineno-26-81"></a>        <span class="c1"># print(data)</span>
</span><span id="__span-26-82"><a id="__codelineno-26-82" name="__codelineno-26-82"></a>
</span><span id="__span-26-83"><a id="__codelineno-26-83" name="__codelineno-26-83"></a>        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-26-84"><a id="__codelineno-26-84" name="__codelineno-26-84"></a>        <span class="n">parity</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'The Seers whisper their answer: ([0-1])'</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-26-85"><a id="__codelineno-26-85" name="__codelineno-26-85"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">parity</span><span class="p">)</span>
</span><span id="__span-26-86"><a id="__codelineno-26-86" name="__codelineno-26-86"></a>        <span class="c1"># parity = test_oracle()</span>
</span><span id="__span-26-87"><a id="__codelineno-26-87" name="__codelineno-26-87"></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">copy</span><span class="p">:</span>
</span><span id="__span-26-88"><a id="__codelineno-26-88" name="__codelineno-26-88"></a>            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patterns</span> <span class="ow">and</span> <span class="n">copy</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="n">index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">copy</span><span class="p">[</span><span class="n">p</span><span class="p">])]</span> <span class="o">!=</span> <span class="n">parity</span><span class="p">:</span>
</span><span id="__span-26-89"><a id="__codelineno-26-89" name="__codelineno-26-89"></a>                <span class="n">patterns</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span id="__span-26-90"><a id="__codelineno-26-90" name="__codelineno-26-90"></a>
</span><span id="__span-26-91"><a id="__codelineno-26-91" name="__codelineno-26-91"></a>        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">patterns</span><span class="p">))</span>
</span><span id="__span-26-92"><a id="__codelineno-26-92" name="__codelineno-26-92"></a>
</span><span id="__span-26-93"><a id="__codelineno-26-93" name="__codelineno-26-93"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">patterns</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="__span-26-94"><a id="__codelineno-26-94" name="__codelineno-26-94"></a>    <span class="k">return</span> <span class="p">(</span><span class="n">patterns</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="__span-26-95"><a id="__codelineno-26-95" name="__codelineno-26-95"></a>
</span><span id="__span-26-96"><a id="__codelineno-26-96" name="__codelineno-26-96"></a>
</span><span id="__span-26-97"><a id="__codelineno-26-97" name="__codelineno-26-97"></a><span class="k">def</span><span class="w"> </span><span class="nf">oracle</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
</span><span id="__span-26-98"><a id="__codelineno-26-98" name="__codelineno-26-98"></a>
</span><span id="__span-26-99"><a id="__codelineno-26-99" name="__codelineno-26-99"></a>    <span class="k">global</span> <span class="n">counter</span>
</span><span id="__span-26-100"><a id="__codelineno-26-100" name="__codelineno-26-100"></a>    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-26-101"><a id="__codelineno-26-101" name="__codelineno-26-101"></a>
</span><span id="__span-26-102"><a id="__codelineno-26-102" name="__codelineno-26-102"></a>    <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s1">'2</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</span><span id="__span-26-103"><a id="__codelineno-26-103" name="__codelineno-26-103"></a>    <span class="n">recvall</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
</span><span id="__span-26-104"><a id="__codelineno-26-104" name="__codelineno-26-104"></a>    <span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">ct</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="si">}</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span><span id="__span-26-105"><a id="__codelineno-26-105" name="__codelineno-26-105"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">recvall</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="__span-26-106"><a id="__codelineno-26-106" name="__codelineno-26-106"></a>    <span class="c1"># print(data)</span>
</span><span id="__span-26-107"><a id="__codelineno-26-107" name="__codelineno-26-107"></a>
</span><span id="__span-26-108"><a id="__codelineno-26-108" name="__codelineno-26-108"></a>    <span class="n">answer</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'The Seers whisper their answer: ([0-9])'</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-26-109"><a id="__codelineno-26-109" name="__codelineno-26-109"></a>    <span class="k">return</span> <span class="n">answer</span>
</span><span id="__span-26-110"><a id="__codelineno-26-110" name="__codelineno-26-110"></a>
</span><span id="__span-26-111"><a id="__codelineno-26-111" name="__codelineno-26-111"></a>
</span><span id="__span-26-112"><a id="__codelineno-26-112" name="__codelineno-26-112"></a>
</span><span id="__span-26-113"><a id="__codelineno-26-113" name="__codelineno-26-113"></a><span class="k">def</span><span class="w"> </span><span class="nf">oracle_attack</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">oracle</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
</span><span id="__span-26-114"><a id="__codelineno-26-114" name="__codelineno-26-114"></a>
</span><span id="__span-26-115"><a id="__codelineno-26-115" name="__codelineno-26-115"></a>    <span class="n">low</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-26-116"><a id="__codelineno-26-116" name="__codelineno-26-116"></a>    <span class="n">high</span> <span class="o">=</span> <span class="n">N</span>
</span><span id="__span-26-117"><a id="__codelineno-26-117" name="__codelineno-26-117"></a>
</span><span id="__span-26-118"><a id="__codelineno-26-118" name="__codelineno-26-118"></a>    <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">patterns</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-26-119"><a id="__codelineno-26-119" name="__codelineno-26-119"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-26-120"><a id="__codelineno-26-120" name="__codelineno-26-120"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">):</span>
</span><span id="__span-26-121"><a id="__codelineno-26-121" name="__codelineno-26-121"></a>        <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span><span id="__span-26-122"><a id="__codelineno-26-122" name="__codelineno-26-122"></a>
</span><span id="__span-26-123"><a id="__codelineno-26-123" name="__codelineno-26-123"></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-26-124"><a id="__codelineno-26-124" name="__codelineno-26-124"></a>    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-26-125"><a id="__codelineno-26-125" name="__codelineno-26-125"></a>
</span><span id="__span-26-126"><a id="__codelineno-26-126" name="__codelineno-26-126"></a>    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">high</span><span class="o">-</span><span class="n">low</span><span class="p">):</span>
</span><span id="__span-26-127"><a id="__codelineno-26-127" name="__codelineno-26-127"></a>
</span><span id="__span-26-128"><a id="__codelineno-26-128" name="__codelineno-26-128"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'counter : </span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</span><span id="__span-26-129"><a id="__codelineno-26-129" name="__codelineno-26-129"></a>
</span><span id="__span-26-130"><a id="__codelineno-26-130" name="__codelineno-26-130"></a>        <span class="n">x</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span><span id="__span-26-131"><a id="__codelineno-26-131" name="__codelineno-26-131"></a>        <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-26-132"><a id="__codelineno-26-132" name="__codelineno-26-132"></a>            <span class="n">po</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-26-133"><a id="__codelineno-26-133" name="__codelineno-26-133"></a>            <span class="n">ct</span> <span class="o">=</span> <span class="p">(</span><span class="n">po</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
</span><span id="__span-26-134"><a id="__codelineno-26-134" name="__codelineno-26-134"></a>            <span class="n">parity</span> <span class="o">=</span> <span class="n">oracle</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>
</span><span id="__span-26-135"><a id="__codelineno-26-135" name="__codelineno-26-135"></a>
</span><span id="__span-26-136"><a id="__codelineno-26-136" name="__codelineno-26-136"></a>            <span class="k">if</span> <span class="n">parity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-26-137"><a id="__codelineno-26-137" name="__codelineno-26-137"></a>                <span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span><span class="o">+</span><span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="__span-26-138"><a id="__codelineno-26-138" name="__codelineno-26-138"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-26-139"><a id="__codelineno-26-139" name="__codelineno-26-139"></a>                <span class="n">low</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span><span class="o">+</span><span class="n">high</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="__span-26-140"><a id="__codelineno-26-140" name="__codelineno-26-140"></a>
</span><span id="__span-26-141"><a id="__codelineno-26-141" name="__codelineno-26-141"></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-26-142"><a id="__codelineno-26-142" name="__codelineno-26-142"></a>            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-26-143"><a id="__codelineno-26-143" name="__codelineno-26-143"></a>            <span class="c1"># pass</span>
</span><span id="__span-26-144"><a id="__codelineno-26-144" name="__codelineno-26-144"></a>
</span><span id="__span-26-145"><a id="__codelineno-26-145" name="__codelineno-26-145"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-26-146"><a id="__codelineno-26-146" name="__codelineno-26-146"></a>            <span class="n">po</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">e</span><span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span id="__span-26-147"><a id="__codelineno-26-147" name="__codelineno-26-147"></a>            <span class="n">ct</span> <span class="o">=</span> <span class="p">(</span><span class="n">po</span> <span class="o">*</span> <span class="n">C</span><span class="p">)</span> <span class="o">%</span> <span class="n">n</span>
</span><span id="__span-26-148"><a id="__codelineno-26-148" name="__codelineno-26-148"></a>            <span class="n">parity</span> <span class="o">=</span> <span class="n">oracle</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">ct</span><span class="p">)</span>
</span><span id="__span-26-149"><a id="__codelineno-26-149" name="__codelineno-26-149"></a>
</span><span id="__span-26-150"><a id="__codelineno-26-150" name="__codelineno-26-150"></a>            <span class="k">if</span> <span class="n">parity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-26-151"><a id="__codelineno-26-151" name="__codelineno-26-151"></a>                <span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span><span class="o">+</span><span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="__span-26-152"><a id="__codelineno-26-152" name="__codelineno-26-152"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-26-153"><a id="__codelineno-26-153" name="__codelineno-26-153"></a>                <span class="n">low</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span><span class="o">+</span><span class="n">high</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span><span id="__span-26-154"><a id="__codelineno-26-154" name="__codelineno-26-154"></a>
</span><span id="__span-26-155"><a id="__codelineno-26-155" name="__codelineno-26-155"></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-26-156"><a id="__codelineno-26-156" name="__codelineno-26-156"></a>            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-26-157"><a id="__codelineno-26-157" name="__codelineno-26-157"></a>            <span class="c1"># pass</span>
</span><span id="__span-26-158"><a id="__codelineno-26-158" name="__codelineno-26-158"></a>
</span><span id="__span-26-159"><a id="__codelineno-26-159" name="__codelineno-26-159"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">high</span><span class="p">)</span>
</span><span id="__span-26-160"><a id="__codelineno-26-160" name="__codelineno-26-160"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">low</span><span class="p">)</span>
</span><span id="__span-26-161"><a id="__codelineno-26-161" name="__codelineno-26-161"></a>
</span><span id="__span-26-162"><a id="__codelineno-26-162" name="__codelineno-26-162"></a>    <span class="k">return</span> <span class="n">low</span>
</span><span id="__span-26-163"><a id="__codelineno-26-163" name="__codelineno-26-163"></a>
</span><span id="__span-26-164"><a id="__codelineno-26-164" name="__codelineno-26-164"></a>
</span><span id="__span-26-165"><a id="__codelineno-26-165" name="__codelineno-26-165"></a>
</span><span id="__span-26-166"><a id="__codelineno-26-166" name="__codelineno-26-166"></a><span class="n">data</span> <span class="o">=</span> <span class="n">recvall</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
</span><span id="__span-26-167"><a id="__codelineno-26-167" name="__codelineno-26-167"></a><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span><span id="__span-26-168"><a id="__codelineno-26-168" name="__codelineno-26-168"></a>
</span><span id="__span-26-169"><a id="__codelineno-26-169" name="__codelineno-26-169"></a><span class="n">M</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'M = ([0-9]+)'</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-26-170"><a id="__codelineno-26-170" name="__codelineno-26-170"></a>
</span><span id="__span-26-171"><a id="__codelineno-26-171" name="__codelineno-26-171"></a><span class="n">sock</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="sa">b</span><span class="s1">'1</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</span><span id="__span-26-172"><a id="__codelineno-26-172" name="__codelineno-26-172"></a>
</span><span id="__span-26-173"><a id="__codelineno-26-173" name="__codelineno-26-173"></a><span class="n">data</span> <span class="o">=</span> <span class="n">recvall</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
</span><span id="__span-26-174"><a id="__codelineno-26-174" name="__codelineno-26-174"></a><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
</span><span id="__span-26-175"><a id="__codelineno-26-175" name="__codelineno-26-175"></a>
</span><span id="__span-26-176"><a id="__codelineno-26-176" name="__codelineno-26-176"></a>
</span><span id="__span-26-177"><a id="__codelineno-26-177" name="__codelineno-26-177"></a><span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'n = ([0-9]+)'</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-26-178"><a id="__codelineno-26-178" name="__codelineno-26-178"></a><span class="n">c</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">'The ancient script has been sealed: ([0-9]+)'</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="__span-26-179"><a id="__codelineno-26-179" name="__codelineno-26-179"></a>
</span><span id="__span-26-180"><a id="__codelineno-26-180" name="__codelineno-26-180"></a><span class="n">patterns</span> <span class="o">=</span> <span class="n">gen_patterns</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</span><span id="__span-26-181"><a id="__codelineno-26-181" name="__codelineno-26-181"></a>
</span><span id="__span-26-182"><a id="__codelineno-26-182" name="__codelineno-26-182"></a>
</span><span id="__span-26-183"><a id="__codelineno-26-183" name="__codelineno-26-183"></a><span class="n">states</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="n">get_state</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">patterns</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span id="__span-26-184"><a id="__codelineno-26-184" name="__codelineno-26-184"></a><span class="nb">print</span><span class="p">(</span><span class="n">states</span><span class="p">)</span>
</span><span id="__span-26-185"><a id="__codelineno-26-185" name="__codelineno-26-185"></a><span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
</span><span id="__span-26-186"><a id="__codelineno-26-186" name="__codelineno-26-186"></a>
</span><span id="__span-26-187"><a id="__codelineno-26-187" name="__codelineno-26-187"></a><span class="n">m</span> <span class="o">=</span> <span class="n">oracle_attack</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mh">0x10001</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">oracle</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</span><span id="__span-26-188"><a id="__codelineno-26-188" name="__codelineno-26-188"></a><span class="n">flag</span> <span class="o">=</span> <span class="n">long_to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="__span-26-189"><a id="__codelineno-26-189" name="__codelineno-26-189"></a><span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>And here is the process and extracted flag(the last byte could get fixed by just subtracting 1 from the final M)</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../../img/twinoracle_flag.png" data-desc-position="bottom"><img alt="../img/twinoracle_flag.png" src="../../img/twinoracle_flag.png"></a></p>
<h2 id="flag">Flag</h2>
<div class="language-text highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a>HTB{1_l0v3_us1ng_RS4_0r4cl3s___3v3n_4_s1ngl3_b1t_1s_3n0ugh_t0_g3t_m3_t0_3ld0r14!_723d443d2e3da66d924780cf2a55953c}
</span></code></pre></div></td></tr></tbody></table></div>
<h2 id="authors">Authors</h2>
<blockquote>
<p><a href="https://github.com/KooroshRZ">Kourosh Rajabzadeh</a></p>
</blockquote>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../../..", "features": ["navigation.tabs", "content.code.copy", "content.code.select", "content.code.annotate", "navigating.sections", "search.suggest", "search.highlight", "search.share", "navigation.path", "navigation.top", "navigation.indexes", "content.code.copy", "content.code.select", "navigation.instant.preview"], "search": "../../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../../../../../assets/js/extra.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>